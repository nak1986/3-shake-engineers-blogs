<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon shortcut" type="image/png" href="https://blog.3-shake.com//logo.png"/><link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&amp;family=Roboto:wght@300;400;500;700&amp;display=swap" rel="stylesheet"/><title>yteraoka | 3-shake Engineers&#x27; Blogs</title><meta property="og:title" content="yteraoka"/><meta property="og:url" content="https://blog.3-shake.com//members/yteraoka"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:site" content="3-shake Engineers&#x27; Blogs"/><meta property="og:image" content="https://blog.3-shake.com//og.png"/><link rel="canonical" href="https://blog.3-shake.com//members/yteraoka"/><link rel="preload" href="/_next/static/css/f1bef31af337ade93f2e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f1bef31af337ade93f2e.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-8a83f0fd99327c4684a8.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1daf1ec1ecf144ee9147.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9e003f150a446b53bdd9.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-7b618a3f94d3d1fc38ed.js" as="script"/><link rel="preload" href="/_next/static/chunks/81b50c7ab23905e464b4340eb234bd6ea389d26b.80b00a9a055ec9a5135d.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/members/%5Bid%5D-82bdc617ad4a0fa06a9e.js" as="script"/></head><body><div id="__next"><header class="site-header"><div class="content-wrapper"><div class="site-header__inner"><a class="site-header__logo-link" href="/"><img src="/logo.svg" alt="3-shake Engineers&#x27; Blogs" class="site-header__logo-img"/><span class="site-header__logo-text">3-shake<br/>Engineers&#x27; Blogs</span></a><div class="site-header__links"><a href="https://3-shake.com/category/recruit/" class="site-header__link">Recruit</a><a href="https://3-shake.com/" class="site-header__link">Company</a></div></div></div></header><section class="member"><div class="content-wrapper"><header class="member-header"><div class="member-header__avatar"><img src="/avatars/yteraoka.jpeg" alt="yteraoka" width="100" height="100" class="member-header__avatar-img"/></div><h1 class="member-header__name">yteraoka</h1><p class="member-header__bio">ojisan</p><div class="member-header__links"><a href="https://twitter.com/yteraoka" class="member-header__link"><img src="/icons/twitter.svg" alt="Twitterのユーザー@yteraoka" width="22" height="22"/></a><a href="https://github.com/yteraoka" class="member-header__link"><img src="/icons/github.svg" alt="GitHubのユーザー@yteraoka" width="22" height="22"/></a><a href="https://blog.1q77.com/" class="member-header__link"><img src="/icons/link.svg" alt="ウェブサイトのリンク" width="22" height="22"/></a></div></header><div class="member-posts-container"><div class="post-list"><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2022-02-26T15:52:27.000Z" class="post-link__date">2 months ago</time></div></a><a href="https://blog.1q77.com/2022/02/istio-exit-on-zero-active-connections/" class="post-link__main-link"><h2 class="post-link__title">istio sidecar の停止を connection がなくなるまで遅らせる</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2022-01-08T05:27:39.000Z" class="post-link__date">3 months ago</time></div></a><a href="https://blog.1q77.com/2022/01/telepresence-part-2/" class="post-link__main-link"><h2 class="post-link__title">telepresence 入門 (2)</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2022-01-04T16:23:46.000Z" class="post-link__date">3 months ago</time></div></a><a href="https://blog.1q77.com/2022/01/docker-on-lima/" class="post-link__main-link"><h2 class="post-link__title">Docker on Lima</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-12-31T14:54:43.000Z" class="post-link__date">4 months ago</time></div></a><a href="https://blog.1q77.com/2021/12/telepresence-part-1/" class="post-link__main-link"><h2 class="post-link__title">telepresence 入門 (1)</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-12-31T07:28:54.000Z" class="post-link__date">4 months ago</time></div></a><a href="https://blog.1q77.com/2021/12/cloudfront-security-headers/" class="post-link__main-link"><h2 class="post-link__title">CloudFront のレスポンスに Security Headers を追加する</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-09-23T14:20:51.000Z" class="post-link__date">7 months ago</time></div></a><a href="https://blog.1q77.com/2021/09/podman-on-mac/" class="post-link__main-link"><h2 class="post-link__title">mac で podman</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-09-19T16:58:10.000Z" class="post-link__date">7 months ago</time></div></a><a href="https://blog.1q77.com/2021/09/lima/" class="post-link__main-link"><h2 class="post-link__title">Lima で nerdctl</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-09-18T16:07:27.000Z" class="post-link__date">7 months ago</time></div></a><a href="https://blog.1q77.com/2021/09/replace-docker-desktop-with-minikube/" class="post-link__main-link"><h2 class="post-link__title">Docker Desktop の代わりに Minikube を使ってみる</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-04-10T14:44:13.000Z" class="post-link__date">a year ago</time></div></a><a href="https://blog.1q77.com/2021/04/step-ca-with-google-oidc/" class="post-link__main-link"><h2 class="post-link__title">Google 認証でクライアント証明書発行のセルフサービス化</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-04-04T04:03:47.000Z" class="post-link__date">a year ago</time></div></a><a href="https://blog.1q77.com/2021/04/terraform-dev_overrides/" class="post-link__main-link"><h2 class="post-link__title">Terraform でカスタム provider を使うための dev_overrides 設定</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=blog.1q77.com" width="14" height="14" class="post-link__site-favicon"/>blog.1q77.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2021-01-13T14:04:22.000Z" class="post-link__date">a year ago</time></div></a><a href="https://qiita.com/yteraoka/items/e74e8bf24f72f7ed5f15" class="post-link__main-link"><h2 class="post-link__title">glibc, musl libc, go の resolver の違い</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2020-10-17T14:52:08.000Z" class="post-link__date">a year ago</time></div></a><a href="https://medium.com/sreake-jp/istio-%E3%81%AE-timeout-retry-circuit-breaking-etc-c170285447e8?source=rss-8b55af126a13------2" class="post-link__main-link"><h2 class="post-link__title">Istio の timeout, retry, circuit breaking, etc</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=medium.com" width="14" height="14" class="post-link__site-favicon"/>medium.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2020-06-02T03:16:16.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://medium.com/sreake-jp/chaos-mesh-%E3%81%AB%E3%82%88%E3%82%8B%E3%82%AB%E3%82%AA%E3%82%B9%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%8B%E3%82%A2%E3%83%AA%E3%83%B3%E3%82%B0-46fa2897c742?source=rss-8b55af126a13------2" class="post-link__main-link"><h2 class="post-link__title">Chaos Mesh によるカオスエンジニアリング</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=medium.com" width="14" height="14" class="post-link__site-favicon"/>medium.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2017-12-22T03:02:36.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://qiita.com/yteraoka/items/41faf5d183b997b66625" class="post-link__main-link"><h2 class="post-link__title">Bitwardenで自分専用パスワードマネージャーサーバー構築</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2017-12-11T05:03:26.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://qiita.com/yteraoka/items/77b329606f44b4e19b92" class="post-link__main-link"><h2 class="post-link__title">STNSの独自サーバーを書いてみた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/yteraoka"><img src="/avatars/yteraoka.jpeg" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">yteraoka</div><time dateTime="2017-12-07T14:39:03.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://qiita.com/yteraoka/items/cfa185f8846850648ab4" class="post-link__main-link"><h2 class="post-link__title">CentOS7でPostgreSQL 10のPacemakerクラスタ作成</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article></div></div></div></section><footer class="site-footer"><div class="content-wrapper"><p>© <!-- -->3-shake Inc.</p></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"member":{"id":"yteraoka","name":"yteraoka","role":"SRE","bio":"ojisan","avatarSrc":"/avatars/yteraoka.jpeg","sources":["https://blog.1q77.com/feed/","https://qiita.com/yteraoka/feed","https://medium.com/feed/@yteraoka","https://zenn.dev/yteraoka/feed"],"includeUrlRegex":"","twitterUsername":"yteraoka","githubUsername":"yteraoka","websiteUrl":"https://blog.1q77.com/"},"postItems":[{"title":"istio sidecar の停止を connection がなくなるまで遅らせる","contentSnippet":"新機能 EXIT_ON_ZERO_ACTIVE_CONNECTIONS 以前、「Istio 導入への道 – sidecar の調整編」という記事で、Istio の sidecar (istio-proxy) が、アプリの終了を待たずに停止してしまってアプリ側が通信できなくなるという問題に対して preStop hook に netstat などを使った wait 処理を入れるというのを紹介しましたが、あれは listen しているプロセスがいなくなるまで待つというもので、nginx などのように処理中のリクエストは完了を待つが、listen している socket は signal を受けるとすぐに close するというサーバーの場合には有効に働きませんでした。これに対して 2021年11月にリリースされた Istio 1.12 では drain モードに変更した後、アクティブなコネクションがなくなるまで待つという設定ができるようになっていました。(drain モードについては後述) Istio 1.12 Change Notes に次のように書かれています。 Added support for envoy to track active connections during drain and quit if active connections […]istio sidecar の停止を connection がなくなるまで遅らせる first appeared on 1Q77.","link":"https://blog.1q77.com/2022/02/istio-exit-on-zero-active-connections/","isoDate":"2022-02-26T15:52:27.000Z","dateMiliSeconds":1645890747000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"telepresence 入門 (2)","contentSnippet":"前回の telepresence 入門 (1) の続きです。今回は Kubernetes クラスタの Service へのアクセスをインターセプトして手元の環境に転送することを試します。Kubernetes 側の volume も手元で mount させるし、環境変数も引っ張ってきます。 バージョンなど環境については前回と同じ。 インターセプト設定 Kubernetes の Service 宛の通信を手元に転送することを　intercept と呼ぶようです。 インターセプト前の状態 前回使った hello という Service, Deployment を使います。 $ kubectl create deploy hello --image=k8s.gcr.io/echoserver:1.4 $ kubectl expose deploy hello --port 80 --target-port 8080 Service は port 80 をコンテナの port 8080 に転送するようになっています。 $ kubectl get svc […]telepresence 入門 (2) first appeared on 1Q77.","link":"https://blog.1q77.com/2022/01/telepresence-part-2/","isoDate":"2022-01-08T05:27:39.000Z","dateMiliSeconds":1641619659000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Docker on Lima","contentSnippet":"以前、「Lima で nerdctl」という記事を書きました。その後、lima の VM 上で docker daemon を実行し、ホスト側から docker コマンドでアクセスするという方法があることを知りました。たまたま、brew upgrade を実行していたところ lima が 0.8.0 に更新されたのを見て Github の releases ページを見、試してみようかなと思ったのでメモです。 ちなみに、前回試した時のバージョンは 0.6.4 でした。 Docker 入りの VM を起動させる 私は brew のインストール先を $HOME にしていますが、brew で lima をインストールすると ~/.homebrew/Cellar/lima/0.8.0/share/doc/lima/examples/docker.yaml に docker 入りの VM を作成するための設定ファイルも一緒にインストールされています。これを使うことで簡単に VM が作成できます。次のように limactl start に続けてファイルの path を指定するだけです。 $ limactl start ~/.homebrew/Cellar/lima/0.8.0/share/doc/lima/examples/docker.yaml ファイルは URL […]Docker on Lima first appeared on 1Q77.","link":"https://blog.1q77.com/2022/01/docker-on-lima/","isoDate":"2022-01-04T16:23:46.000Z","dateMiliSeconds":1641313426000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"telepresence 入門 (1)","contentSnippet":"telepresence というツールがあります。手元の端末が Kubernetes クラスタ内にいるかのような通信を可能にし、Kubernetes の Pod の Container への通信をインターセプトして手元の端末に流すことができます。これの仕組みを調べてみます。(以前は Python で書かれていたようですが、v2 は Go で書き直されたみたいです) 確認に使用した telepresence と mac の version $ telepresence version Client: v2.4.9 (api v3) $ sw_vers ProductName: macOS ProductVersion: 12.1 BuildVersion: 21C52 Kubernetes クラスタは GKE の v1.21.5-gke.1302 クラスタへの terffic-manager のデプロイ helm を使ってインストールすることができます。デフォルトではクラスタワイドな設定になりますが、特定の namespace にのみインストールしたり、namespace 毎に権限を分けてインストールすることも可能です。 $ helm repo add datawire https://app.getambassador.io $ […]telepresence 入門 (1) first appeared on 1Q77.","link":"https://blog.1q77.com/2021/12/telepresence-part-1/","isoDate":"2021-12-31T14:54:43.000Z","dateMiliSeconds":1640962483000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"CloudFront のレスポンスに Security Headers を追加する","contentSnippet":"「Amazon CloudFront が設定可能な CORS、セキュリティ、およびカスタム HTTP レスポンスヘッダーをサポート」で Lambda@Edge なしで Response にカスタムヘッダーを追加することが可能になりました。 これを使って、このサイトにも Security Headers を追加してみます。 CloudFront のコンソールで、Policies → Response headers にアクセスすると Managed policies があり、次のポリシーが存在します。 CORS-and-SecurityHeadersPolicy CORS-With-Preflight CORS-with-preflight-and-SecurityHeadersPolicy SecurityHeadersPolicy SimpleCORS SecurityHeaders と CORS の組み合わせパターンですね。 SecurityHeadersPolicy ではレスポンスに次の Header がセットされます。 Strict-Transport-Security: max-age=31536000 X-Content-Type-Options: nosniff X-Frame-Options: SAMEORIGIN X-XSS-Protection: 1; mode=block Referrer-Policy: strict-origin-when-cross-origin これを Distributions → Behaviors の Response headers policy […]CloudFront のレスポンスに Security Headers を追加する first appeared on 1Q77.","link":"https://blog.1q77.com/2021/12/cloudfront-security-headers/","isoDate":"2021-12-31T07:28:54.000Z","dateMiliSeconds":1640935734000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"mac で podman","contentSnippet":"Docker Desktop 代替シリーズ第三部、Podman です。(第一部 minkikube 編、第二部 Lima + nerdctl 編) Podman については Red Hat さんのブログが大変参考になります。 今回の Docker 社によるライセンス周りの変更が発表されるよりだいぶ前に How to replace Docker with Podman on a Mac という記事もありました。Podman は Linux 上で稼働する daemon とそのクライアントという構成となっており、Windows と Mac にはクライアントしかありません。この時の記事では Vagrant を使って Linux 仮想サーバーを起動させるという処理を macOS app にしようという内容でした。現在は podman machine というサブコマンドで仮想サーバーを起動させることができるようになっているようです。それでは試してみましょう。 podman のインストール $ brew install podman これにより podman, podman-remote, […]mac で podman first appeared on 1Q77.","link":"https://blog.1q77.com/2021/09/podman-on-mac/","isoDate":"2021-09-23T14:20:51.000Z","dateMiliSeconds":1632406851000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Lima で nerdctl","contentSnippet":"Docker Desktop の代わりに docker cli + Minikube ってのを試しただけど、Kubernetes は docker を非推奨にしてるし、kubernetes は不要な場合は無駄が多いしなあ… ってことで lima も試してみる。 (2021/01/05 追記: Docker on Lima も見てね) Lima は自動のファイル共有、ポートフォワード、containerd をサポートした仮想マシンを提供してくれるツール。Windows subsystem for Linux の mac 版とも言えるとドキュメントに書かれている。 今回は Intel Mac 環境で試しています。M1 Mac の場合は qemu に patch が必要みたいです。 Lima のインストール Homebrew でインストール $ brew install lima Lima Virtual Machine の起動 limactl コマンドを使う $ […]Lima で nerdctl first appeared on 1Q77.","link":"https://blog.1q77.com/2021/09/lima/","isoDate":"2021-09-19T16:58:10.000Z","dateMiliSeconds":1632070690000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Docker Desktop の代わりに Minikube を使ってみる","contentSnippet":"Docker のおかげで今の便利なコンテナがあります、ありがとうございます。でもどうなるのかやってみたかったんです。 Goodbye Docker Desktop, Hello Minikube! を参考に試してみます。 環境は Intel Mac の Big Sur です。Mac で docker を使うには docker daemon を稼働させるための Linux 仮想マシンが必要で、Docker Desktop はそこをうまいことやってくれています。その docker daemon の稼働する仮想マシンとして minikube 用のものを活用しようという話です。 Docker Desktop の Uninstall アプリとしては消したけどでっかい VM のイメージは残ってるから、もう再度インストールすることもないという状況になったら削除しよう。 ~/Library/Containers/com.docker.docker/Data/vms/0/data/Docker.raw Docker CLI の Install $ brew install docker 必要なら docker-compose も。ただし、今時は docker のサブコマンドになっているので docker-compose コマンドをインストールする必要はなさそう。 $ brew […]Docker Desktop の代わりに Minikube を使ってみる first appeared on 1Q77.","link":"https://blog.1q77.com/2021/09/replace-docker-desktop-with-minikube/","isoDate":"2021-09-18T16:07:27.000Z","dateMiliSeconds":1631981247000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Google 認証でクライアント証明書発行のセルフサービス化","contentSnippet":"以前、caddy について調べてて発見した smallstep でクライアント証明書発行を便利にできないかなということで調査です。(Hashicorp Vault でもできるっぽいけど用途的にわざわざクラスタ組むの面倒だなあって) Connect your identity provider and issue X.509 certificates for user authentication to services というドキュメントを参考に進めます。前提に Getting Started でセットアップした step-ca が起動していることとあるので、まずはこちらから。 Getting Started まずは、step と step-ca コマンドをインストール。Homebrew でもインストールできます。 CA の初期化 ファイルの保存場所をカレントディレクトリ配下にしておきます。デフォルトでは $HOME/.step となっています。 export STEPPATH=./step step ca init で root と intermediate 証明書を作成します。$STEPPATH/config/defaults.json と $STEPPATH/config/ca.json というファイルも生成されます。defaults.json の方は step コマンド用で、ca.json は CA […]Google 認証でクライアント証明書発行のセルフサービス化 first appeared on 1Q77.","link":"https://blog.1q77.com/2021/04/step-ca-with-google-oidc/","isoDate":"2021-04-10T14:44:13.000Z","dateMiliSeconds":1618065853000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Terraform でカスタム provider を使うための dev_overrides 設定","contentSnippet":"healthchecks.io が大変便利なので Self-hosted なサーバーを用意して、設定を terraform で管理したいなあということがありまして、terraform-provider-healthchecksio の接続先サーバーを指定可能にしようと思いました。provider のコードを編集して build するところまではすぐに出来たのですが、このバイナリを terraform からどうやって使うのかな？でハマったのでメモです。 Terraform 0.14 から ~/.terraformrc の provider_installation 内に dev_overrides という設定を書くことができるようになっていました。(Development Overrides for Provider Developers) ~/.terraformrc に次の設定を入れておけば、指定したディレクトリ直下にあるバイナリを使ってくれます。場所はどこでも良いですが、ここで go build すればバイナリが生成されるのでそのまま使えるようにここを指定してみました。 provider_installation { dev_overrides { \"kristofferahl/healthchecksio\" = \"/Users/teraoka/ghq/github.com/yteraoka/terraform-provider-healthchecksio\" } direct {} } terraform init では次のような Warning が表示されます。 % terraform init Initializing the backend... Initializing provider plugins... […]Terraform でカスタム provider を使うための dev_overrides 設定 first appeared on 1Q77.","link":"https://blog.1q77.com/2021/04/terraform-dev_overrides/","isoDate":"2021-04-04T04:03:47.000Z","dateMiliSeconds":1617509027000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"glibc, musl libc, go の resolver の違い","contentSnippet":"先日、resolv.conf で timeout を調整したいなと思うことがありました、しかし、Docker だの Kubernetes だのといった時代です。Linux しか使っていなかったとして…","link":"https://qiita.com/yteraoka/items/e74e8bf24f72f7ed5f15","isoDate":"2021-01-13T14:04:22.000Z","dateMiliSeconds":1610546662000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Istio の timeout, retry, circuit breaking, etc","link":"https://medium.com/sreake-jp/istio-%E3%81%AE-timeout-retry-circuit-breaking-etc-c170285447e8?source=rss-8b55af126a13------2","isoDate":"2020-10-17T14:52:08.000Z","dateMiliSeconds":1602946328000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Chaos Mesh によるカオスエンジニアリング","link":"https://medium.com/sreake-jp/chaos-mesh-%E3%81%AB%E3%82%88%E3%82%8B%E3%82%AB%E3%82%AA%E3%82%B9%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%8B%E3%82%A2%E3%83%AA%E3%83%B3%E3%82%B0-46fa2897c742?source=rss-8b55af126a13------2","isoDate":"2020-06-02T03:16:16.000Z","dateMiliSeconds":1591067776000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"Bitwardenで自分専用パスワードマネージャーサーバー構築","contentSnippet":"Qiita では初の Bitwarden 記事っぽい パスワードマネージャーサービスは有償、無償でいくつかありますが 1password.com がメジャーどころでしょうか。家族プランがあって良さげ…","link":"https://qiita.com/yteraoka/items/41faf5d183b997b66625","isoDate":"2017-12-22T03:02:36.000Z","dateMiliSeconds":1513911756000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"STNSの独自サーバーを書いてみた","contentSnippet":"オンプレサーバーに加え、複数のクラウドサービスや VPS を使うようになってくると Linux サーバーのアカウント管理が非常に面倒になってきました。（全てがコンテナと SaaS になるのはまだ先）そこで以前から気になっていた…","link":"https://qiita.com/yteraoka/items/77b329606f44b4e19b92","isoDate":"2017-12-11T05:03:26.000Z","dateMiliSeconds":1512968606000,"authorName":"yteraoka","authorId":"yteraoka"},{"title":"CentOS7でPostgreSQL 10のPacemakerクラスタ作成","contentSnippet":"クラウドのマネージドサービスが楽でいいよなぁと思いながら CentOS 7 + PostgreSQL 10 のサーバー3台で pacemaker を使ったクラスタを作成してみますTL;DRVag…","link":"https://qiita.com/yteraoka/items/cfa185f8846850648ab4","isoDate":"2017-12-07T14:39:03.000Z","dateMiliSeconds":1512657543000,"authorName":"yteraoka","authorId":"yteraoka"}]},"__N_SSG":true},"page":"/members/[id]","query":{"id":"yteraoka"},"buildId":"rcRGZg09I8A3pTqsz_mOP","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"name":"viewport","content":"width=device-width"}],["meta",{"charSet":"utf-8"}],["link",{"rel":"icon shortcut","type":"image/png","href":"https://blog.3-shake.com//logo.png"}],["link",{"href":"https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700\u0026family=Roboto:wght@300;400;500;700\u0026display=swap","rel":"stylesheet"}],["title",{"children":"yteraoka | 3-shake Engineers' Blogs"}],["meta",{"property":"og:title","content":"yteraoka"}],["meta",{"property":"og:url","content":"https://blog.3-shake.com//members/yteraoka"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"property":"og:site","content":"3-shake Engineers' Blogs"}],["meta",{"property":"og:image","content":"https://blog.3-shake.com//og.png"}],["link",{"rel":"canonical","href":"https://blog.3-shake.com//members/yteraoka"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-4beebf4ac9054f0bf4e6.js"></script><script src="/_next/static/chunks/main-8a83f0fd99327c4684a8.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.1daf1ec1ecf144ee9147.js" async=""></script><script src="/_next/static/chunks/commons.9e003f150a446b53bdd9.js" async=""></script><script src="/_next/static/chunks/pages/_app-7b618a3f94d3d1fc38ed.js" async=""></script><script src="/_next/static/chunks/81b50c7ab23905e464b4340eb234bd6ea389d26b.80b00a9a055ec9a5135d.js" async=""></script><script src="/_next/static/chunks/pages/members/%5Bid%5D-82bdc617ad4a0fa06a9e.js" async=""></script><script src="/_next/static/rcRGZg09I8A3pTqsz_mOP/_buildManifest.js" async=""></script><script src="/_next/static/rcRGZg09I8A3pTqsz_mOP/_ssgManifest.js" async=""></script></body></html>