{"pageProps":{"member":{"id":"tozastation","name":"tozastation","role":"SRE","bio":"tarako_chan","avatarSrc":"/avatars/tozastation.jpg","sources":["https://qiita.com/tozastation/feed"],"includeUrlRegex":"","twitterUsername":"tozastation","githubUsername":"tozastation","websiteUrl":"https://github.com/tozastation"},"postItems":[{"title":"Kubernetes (k8s) ç®¡ç†è€…ç”¨GUI Lens","contentSnippet":"Lensã¨ã¯lensapp/lensk8sã§å‹•ä½œã™ã‚‹å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã—ã¦ãã‚Œã‚‹GUIã‚¢ãƒ—ãƒªLinux/Mac/Windowsã§å‹•ä½œã™ã‚‹ã“ã‚“ãªæ„Ÿã˜ï¼ˆkindã§ä½œã£ãŸã‚¯ãƒ©ã‚¹ã‚¿è¦‹ã¦ã¾ã™ï¼‰åŠ©ã‹ã‚Šãƒã‚¤ãƒ³ãƒˆãƒªã‚½ãƒ¼ã‚¹ï¼ˆPod/Namespace/CRD/etc...ï¼‰ãŒãªã‚“ã‹ãŠã‹ã—ã„kubectl describeã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç¢ºèªã™ã‚‹ -> ã‚³ãƒãƒ³ãƒ‰é•·ã„ -> Lensä½¿ã†å…¨ã¦ã®åå‰ç©ºé–“ã®ã‚¢ãƒ—ãƒªã‚’ä¸€è¦§ã§ãã‚‹æ©Ÿèƒ½ãŒã‚ã‚ŠãŒãŸã„ -> ï¼ˆk get po -A -o wideä»¥ä¸Šã®æƒ…å ±âœ¨ï¼‰Podã®ãƒ­ã‚°ã¾ã§è¦‹ãŸã„æ™‚ã¯ï¼Œk9sã‚’ä½¿ã£ã¦ã¾ã™ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ã„ãã¤ã‚‚ç®¡ç†ã—ã¦ã‚‹å ´åˆï¼ˆDev/Stg/(Prd) + åˆ¥PJ ...ï¼‰ã«ï¼Œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ‡ã‚Šæ›¿ãˆç­‰ç®¡ç†ãŒç…©é›‘ã« -> Lensä½¿ã†Slackã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«å‚åŠ ã™ã‚‹ã‹ã®ã‚ˆã†ã«ï¼Œå·¦ã‚¿ãƒ–ã«ã‚¯ãƒ©ã‚¹ã‚¿ã‚’è¿½åŠ ã—ã™ãã«åˆ‡ã‚Šæ›¿ãˆç¢ºèªã§ãã‚‹âœ¨ä»¥ä¸Šã§ã™ï¼å¿«é©ãªk8sãƒ©ã‚¤ãƒ•ã‚’ãƒ¼ãƒ¼ãƒ¼ï¼","link":"https://qiita.com/tozastation/items/804949c69df5d53643c6","isoDate":"2020-09-07T12:53:18.000Z","dateMiliSeconds":1599483198000,"authorName":"tozastation","authorId":"tozastation"},{"title":"ãƒ†ã‚¹ãƒˆã§ä½¿ã„ãŸãã¦ï¼ŒDinD (Docker in Docker) ã§k8sã®ç’°å¢ƒã‚’æ•´ãˆãŸ","contentSnippet":"TL;DRã“ã¡ã‚‰ã®Dockerfileã‚’è¦‹ç´ã‚ãã ã•ã„kindã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’åˆ†ã‘ã¦ã‚‚è‰¯ã‹ã£ãŸã®ã§ã™ãŒï¼Œkubeconfigã®å—ã‘æ¸¡ã—ãŒé¢å€’ã ã£ãŸã®ã§å¦¥å”ã—ã¾ã—ãŸhttps://github.com/tozastation/kw/blob/master/Dockerfile.testäº‹ã®çµŒç·¯Kubernetesã‚’åˆ¶å¾¡ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’æ›¸ããŸã„ï¼ãƒ†ã‚¹ãƒˆã®ãŸã‚ã«ï¼ŒKubernetesã‚¯ãƒ©ã‚¹ã‚¿ã‚’ãƒ›ã‚¹ãƒˆPCã«å»ºã¦ã‚‹ã®é¢å€’ã ã—ï¼Œç’°å¢ƒã‚’æ±šã—ãŸããªã„ï¼ï¼ï¼kind (kubernetes in docker) ãªã‚‹ã‚‚ã®ã‚’ç™ºè¦‹ã—ã‹ã—ï¼Œã‚¢ãƒ—ãƒªã®é–‹ç™ºã‚’Dockerå†…ã§è¡Œã£ã¦ã„ã‚‹ã¨ï¼Œkindã¨ã‚¢ãƒ—ãƒªã®ã‚³ãƒ³ãƒ†ãƒŠã¯åŒä¸€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å‚åŠ ã—ã¦ã„ãªã„ãŸã‚ï¼Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çš„ã«å‚ç…§ã§ããªã„ã¨ã„ã†å•é¡ŒãŒã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œã‚‹ã¨ãã«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æŒ‡å®šã™ã‚‹ç³»ã®issueã‚’è¦‹ã¤ã‘ãŸãã“ã§ï¼ŒDinD (Docker in Docker)ã‚¯ãƒ©ã‚¹ã‚¿ã®ä½œæˆã‚’ãƒ›ã‚¹ãƒˆå´ã§ãªãï¼Œã‚³ãƒ³ãƒ†ãƒŠå†…ã®Dockerã§è¡Œã†ã“ã¨ã«ã‚ˆã£ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çš„ã«å‚ç…§å¯èƒ½ã«ã™ã‚‹ï¼  kind in DinDdocker:dindã¨ã„ã†ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒAlpineãªã®ã§è¿½åŠ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚‹å ´åˆã¯ï¼Œapkã‚’ä½¿ã„ã¾ã™ï¼ä½¿ã„æ–¹ã¯ã“ã¡ã‚‰ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚Šã¾ã™FROM docker:dindRUN apk --no-cache add curlRUN curl -Lo /usr/local/bin/kind https://github.com/kubernetes-sigs/kind/releases/download/v0.6.1/kind-$(uname)-amd64 && chmod +x /usr/local/bin/kindkindã§ã‚¯ãƒ©ã‚¹ã‚¿ä½œæˆ (Docker Deamonã®èµ·å‹•ã‚’å¾…ã¤å¿…è¦ã‚ã‚Š)ä»¥ä¸‹ã‚’ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œã™ã‚Œã°ç’°å¢ƒæ§‹ç¯‰å®Œäº†ã§ã™ï¼# ã‚¯ãƒ©ã‚¹ã‚¿ã®ä½œæˆ kind create cluster# KUBECONFIGã«ï¼Œä½œæˆã—ãŸã‚¯ãƒ©ã‚¹ã‚¿ã®kubeconfigãƒ‘ã‚¹ã‚’ç™»éŒ² export KUBECONFIG=\"$(kind get kubeconfig-path --name=\"kind\")\"dindã‚³ãƒ³ãƒ†ãƒŠã‚’ç«‹ã¡ä¸Šã’ã‚‹ã¨ãã«è©°ã¾ã£ãŸç‚¹å•é¡Œdocker run æ™‚ã«ï¼Œã‚³ãƒãƒ³ãƒ‰ã‚’æ¸¡ã™ã¨docker deamonãŒèµ·å‹•ã—ãªãï¼Œkindã‚’å®Ÿè¡Œã§ããªã‹ã£ãŸè§£æ±ºç­–docker run å®Ÿè¡Œå¾Œï¼Œexecã§ã‚³ãƒãƒ³ãƒ‰ã‚’æ¸¡ã™ã‚ˆã†ã«ã™ã‚‹ã¾ã¨ã‚kubernetesã®ç’°å¢ƒæ§‹ç¯‰ã¯ï¼Œminikubeãªã‚ŠkindãŒï¼ŒDockerã§æ§‹ç¯‰ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¦ãã‚Œã¦ã„ã¦éå¸¸ã«ä¾¿åˆ©ã ãªã¨æ€ã„ã¾ã—ãŸï¼ãŠè©¦ã—ã§æ°—è»½ã«å»ºã¦ã‚‹ã¨ãã«ã¯è‡ªåˆ†ã‚‚é‡å®ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ï¼DinDã¯åˆã‚ã¦ä½¿ã„ã¾ã—ãŸãŒï¼Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«DockerãŒä½œã‚Œã‚‹ãŸã‚ãƒ›ã‚¹ãƒˆã‹ã‚‰è¦‹ãŸã¨ãã®ã‚³ãƒ³ãƒ†ãƒŠãŒæ•£ã‚‰ã‹ã‚‰ãªãã¦ç®¡ç†ã—ã‚„ã™ãã†ã¨ã„ã†å°è±¡ã§ã™ï¼Kubernetesã‚¢ãƒ—ãƒªã¨ã‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ä½œã£ã¦ã„ã‚‹ä¸–ã®æ–¹ã€…ã¯ãƒ†ã‚¹ãƒˆç”¨ã®ã‚¯ãƒ©ã‚¹ã‚¿æ§‹ç¯‰ã¨ã‹ã©ã†ã•ã‚Œã¦ã„ã‚‹ã®ã‹ãªã¨æ°—ã«ãªã‚Šã¾ã—ãŸï¼","link":"https://qiita.com/tozastation/items/eafde1a75c35bb9d1a68","isoDate":"2019-12-30T14:30:36.000Z","dateMiliSeconds":1577716236000,"authorName":"tozastation","authorId":"tozastation"},{"title":"IstioãŒä½œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥~ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤~","contentSnippet":"ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªé¡Œæ: BookInfo ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³â€» äº‹å‰ã«Istioã‚’Kubernetesã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãŠã„ã¦ãã ã•ã„ï¼æ§‹æˆã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤istio-1.0.6 directorykubectl apply -f samples/bookinfo/platform/kube/bookinfo.yamlbookinfo.yamlå–ã‚Šæ•¢ãˆãšï¼Œä¸€éƒ¨åˆ†ã‚’æŠ½å‡ºã—ã¦ã¿ã¾ã—ãŸï¼æ™®æ®µãªã‚‰targetPortã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ãŒï¼Œã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ãŸã‚ï¼ŒæŒ‡å®šã—ãªãã¦ã‚‚å¤§ä¸ˆå¤«ã¨è¨€ã†ã“ã¨ãªã®ã§ã—ã‚‡ã†ã‹ï¼ãã‚Œä»¥å¤–ã¯å·®ã—å½“ãŸã£ã¦ã„ã¤ã‚‚é€šã‚Šã®yamlã‹ãªã¨æ€ã„ã¾ã—ãŸï¼ãã‚Œã§ã¯æ¬¡ã«è¡Œãã¾ã—ã‚‡ã†ï¼################################################################################################### Details service##################################################################################################apiVersion: v1kind: Servicemetadata:  name: details  labels:    app: detailsspec:  ports:  - port: 9080    name: http  selector:    app: details---apiVersion: extensions/v1beta1kind: Deploymentmetadata:  name: details-v1spec:  replicas: 1  template:    metadata:      labels:        app: details        version: v1    spec:      containers:      - name: details        image: istio/examples-bookinfo-details-v1:1.8.0        imagePullPolicy: IfNotPresent        ports:        - containerPort: 9080Ingress Envoy(Gatewayã®ãƒ‡ãƒ—ãƒ­ã‚¤)# ingressã®ãƒ‡ãƒ—ãƒ­ã‚¤kubectl apply -f samples/bookinfo/networking/bookinfo-gateway.yamlbookinfo-gateway.yamlã„ããªã‚ŠapiVersionã«æ³¨ç›®ã§ã™ã­ï¼networking.istio.io/v1alpha3ãŒä½¿ã‚ã‚Œã¦ã„ã¾ã™ï¼Istioã«ã‚ˆã‚‹æ‹¡å¼µAPIã§ã—ã‚‡ã†ã‹ï¼Gatewayã¨Virtual Serviceã©ã¡ã‚‰ã‚‚åˆã‚ã¦èãã¾ã—ãŸï¼ç­†è€…ã¯Gatewayã«å¯¾ã™ã‚‹Deploymentã¨ConfigMapãŒã“ã®äºŒã¤ã‹ãªã¨è§£é‡ˆã—ã¾ã—ãŸï¼apiVersion: networking.istio.io/v1alpha3kind: Gatewaymetadata:  name: bookinfo-gatewayspec:  selector:    istio: ingressgateway # use istio default controller  servers:  - port:      number: 80      name: http      protocol: HTTP    hosts:    - \"*\"---apiVersion: networking.istio.io/v1alpha3kind: VirtualServicemetadata:  name: bookinfospec:  hosts:  - \"*\"  gateways:  - bookinfo-gateway  http: # /api/v1/products/ + /productpage or /login or /logout ã ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ï¼Œproductpageã«æµã™ã¿ãŸã„ã§ã™ã­ï¼  - match:    - uri:        exact: /productpage    - uri:        exact: /login    - uri:        exact: /logout    - uri:        prefix: /api/v1/products    route:    - destination:        host: productpage        port:          number: 9080ã¾ã¨ã‚istioã«åˆ©ç”¨ã™ã‚‹ã«ã‚ãŸã£ã¦å¢—ãˆãŸAPIã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ï¼æ¬¡ã¯ï¼Œã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼","link":"https://qiita.com/tozastation/items/1f3c3f213b42e1689406","isoDate":"2019-03-14T05:18:21.000Z","dateMiliSeconds":1552540701000,"authorName":"tozastation","authorId":"tozastation"},{"title":"IstioãŒä½œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥~ç’°å¢ƒæ§‹ç¯‰~","contentSnippet":"ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã¨ã¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã¨ã„ã†ç”¨èªã¯ï¼Œãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒæ§‹ç¯‰ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç›¸äº’ä½œç”¨ã‚’è¡¨ã—ã¾ã™ï¼ â€»ã€€è¤‡æ•°ã®PodãŒç›¸äº’æ¥ç¶šã—ã¦ã„ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã ã¨è§£é‡ˆã—ã¦ã„ã¾ã™ï¼ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥ãŒæŠ±ãˆã‚‹å•é¡Œã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã®è¦æ¨¡ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ï¼Œç®¡ç†ãŒé›£ã—ããªã‚‹ï¼ãã‚Œã¯ï¼Œã‚µãƒ¼ãƒ“ã‚¹ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒª[1]ï¼Œè² è·åˆ†æ•£ï¼Œéšœå®³å›å¾©ï¼Œãƒ­ã‚°åé›†ãªã©ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ï¼[1]: ã©ã®ã‚µãƒ¼ãƒä¸Šã§ã©ã®ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ãŒå‹•ä½œã—ã¦ã„ã‚‹ã‹ã«åŠ ãˆã€ãã®ãƒãƒ¼ãƒˆç•ªå·ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ›ã‚¹ãƒˆåãªã©ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãã®ä»–ã«ã‚‚A/Bãƒ†ã‚¹ãƒˆ[1]ï¼Œã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹[2]ï¼Œãƒ¬ãƒ¼ãƒˆåˆ¶é™[3]ãªã©ã€ã‚ˆã‚Šè¤‡é›‘ãªé‹ç”¨è¦ä»¶ã‚‚æŒ™ã’ã‚‰ã‚Œã‚‹ï¼[1] A/Bãƒ†ã‚¹ãƒˆãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã®ä¸€éƒ¨ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚„ãƒšãƒ¼ã‚¸ãã®ã‚‚ã®ã‚’è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ç”¨æ„ã—ï¼Œãã‚Œã‚‰ã‚’ä¸è¦å‰‡ã«è¡¨ç¤ºã•ã›ï¼Œã©ã¡ã‚‰ãŒã‚ˆã‚Šå¤šãã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‹ï¼Œã‚ˆã‚Šå¤šãç”³ã—è¾¼ã¿ãŒã‚ã£ãŸã‹ãªã©ã‚’æ¤œè¨¼ã™ã‚‹è¡Œç‚ºã®ã“ã¨[2] ã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹æ–°è¦ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚„ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ¬ç•ªç’°å¢ƒã®ä¸€éƒ¨åˆ†ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ï¼Œå…ˆã«ä¸€éƒ¨ã®ãƒ¦ãƒ¼ã‚¶ã«æä¾›ã™ã‚‹ã“ã¨ã§æ–°æ©Ÿèƒ½ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚°ã‚’ã„ã¡æ—©ãå¾—ã‚‹ã“ã¨ã§æ©Ÿèƒ½ã¨ã—ã¦ã®å¿…è¦æ€§ã‚’å—ã‘å–ã£ãŸã†ãˆã§ï¼Œå…¨ã¦ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã†ã¨ã„ã†æ–¹æ³•è¤‡æ•°ã®ãƒãƒ¼ãƒ‰ã§æ§‹æˆã•ã‚ŒãŸé‹ç”¨ã‚µãƒ¼ãƒã®ä¸€éƒ¨åˆ†ã®ãƒãƒ¼ãƒ‰ã«ã®ã¿ãƒªãƒªãƒ¼ã‚¹ã‚’è¡Œã„ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸä¸€éƒ¨ã®ãƒãƒ¼ãƒ‰ã«ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ã¦ã‹ã‚‰ã€å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã†ã¨ã„ã£ãŸæ–¹æ³•[3] ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã“ã“ã¯ã‚€ã—ã‚è‡ªåˆ†ãŒçŸ¥ã‚ŠãŸã„å†…å®¹ã§ã‚‚ã‚ã‚Šã¾ã™ï¼APIã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚’åˆ¶é™ã™ã‚‹æ–¹æ³•Istioã¨ã¯ã“ã‚Œã‚‰ã®è¦ä»¶ã«å¯¾ã—ï¼Œã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥å…¨ä½“ã«é–¢ã™ã‚‹é‹ç”¨ç®¡ç†ã‚’æä¾›ã—ã¦ãã‚Œã¾ã™ï¼Istioã®ãƒ¡ãƒªãƒƒãƒˆæ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãªãï¼Œã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã®ç®¡ç†ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼â€» Podã®å…ˆé ­ã«Envoyã¨ã„ã†ãƒ—ãƒ­ã‚­ã‚·ã‚’ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã¨ã—ã¦é…ç½®ã™ã‚‹ã“ã¨ã§ãƒ¡ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç®¡ç†ã—ã¾ã™ï¼â€» Podã‹ã‚‰ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹é–“é€šä¿¡ã‚‚ã‚»ã‚­ãƒ¥ã‚¢ã«è¡Œã£ã¦ãã‚Œã‚‹IstioãŠè©¦ã—Istioã®ãƒªãƒªãƒ¼ã‚¹ç‰ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰curl -L https://git.io/getLatestIstio | sh -â€» ã“ã®å¾Œã«ãƒ‘ã‚¹ã‚’é€šã—ã¾ã™ãŒè‡ªåˆ†ã®ç’°å¢ƒã ã¨shellãŒã¶ã£å£Šã‚Œã¾ã—ãŸï¼curlå¾Œã«æ¨å¥¨ã•ã‚Œã‚‹ãƒ‘ã‚¹ã‚’é€šã™ã¨ä¸Šæ‰‹ãã„ãã¾ã—ãŸï¼minikubeã®èµ·å‹•minikube start --memory=8192 --cpus=4 --kubernetes-version=v1.10.0 \\    --extra-config=controller-manager.cluster-signing-cert-file=\"/var/lib/localkube/certs/ca.crt\" \\    --extra-config=controller-manager.cluster-signing-key-file=\"/var/lib/localkube/certs/ca.key\" \\    --vm-driver=`your_vm_driver_choice`â€» your_vm_driver_choice = virtualboxã‚«ã‚¹ã‚¿ãƒ ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‡ãƒ—ãƒ­ã‚¤# in istio-1.0.6 directorykubectl apply -f install/kubernetes/helm/istio/templates/crds.yamlIstioã®ãƒ‡ãƒ—ãƒ­ã‚¤# k8så®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡ºåŠ›helm template install/kubernetes/helm/istio --name istio --namespace istio-system > istio.yaml# Namespaceã®ä½œæˆkubectl create namespace istio-system# ãƒ‡ãƒ—ãƒ­ã‚¤kubectl apply -f istio.yamlã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ç¢ºèª# ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤kubectl apply -f samples/sleep/sleep.yaml# Podã®ç¢ºèªkubectl get pods# ã¾ã ï¼Œã€€Podå†…ã®ã‚³ãƒ³ãƒ†ãƒŠã¯ä¸€ã¤ãƒ»ãƒ»ãƒ»NAME                     READY   STATUS    RESTARTS   AGEsleep-79cc87b6b9-cjgbk   1/1     Running   0          4mâ€» ã“ã“ã§ä½•æ•…ã‹minikubeã ã¨ï¼ŒPodãŒç”Ÿæˆã•ã‚Œãªã‹ã£ãŸãŸã‚ï¼ŒDocker for Desctopã«ã¦ï¼Œkubernetesã‚’èµ·å‹•ã—ã¾ã—ãŸï¼ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’åå‰ç©ºé–“å˜ä½ã§æœ‰åŠ¹ã«ã™ã‚‹# ãƒ©ãƒ™ãƒªãƒ³ã‚°kubectl label namespace default istio-injection=enabled# ç¢ºèªkubectl get namespace -L istio-injectionã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª# Podã‚’ä¸€åº¦æ¶ˆå»kubectl delete pod ãƒãƒƒãƒ‰å# ç„¡äº‹ã«ã§ãã¦ã„ãã†ï¼NAME                     READY   STATUS    RESTARTS   AGEsleep-79cc87b6b9-gwxz9   2/2     Running   0          38sã¾ã¨ã‚ä»Šå›ã¯ï¼Œã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥ãŒæŠ±ãˆã‚‹å•é¡Œã¨lstioã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãã—ã¦ï¼Œlstioã®ç’°å¢ƒæ§‹ç¯‰ã‚’è¡Œã„ã¾ã—ãŸï¼æ¬¡ã¯ï¼Œå…¬å¼ã®ä¾‹ã‚’å…ƒã«lstioã‚’ã‚¬ã‚·ã‚¬ã‚·ä½¿ã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ï¼å‚ç…§IstioA/Bãƒ†ã‚¹ãƒˆã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹ãƒ¬ãƒ¼ãƒˆåˆ¶é™","link":"https://qiita.com/tozastation/items/e2f3029a8d7636da1fba","isoDate":"2019-03-14T04:08:22.000Z","dateMiliSeconds":1552536502000,"authorName":"tozastation","authorId":"tozastation"},{"title":"k8sã«APIã‚µãƒ¼ãƒã‚’ãƒ‡ãƒ—ãƒ­ã‚¤","contentSnippet":"ã§ã¯æ—©é€ŸDockerã‚’ä½¿ã£ã¦ã„ãŸæ–¹ã¯å…¥ã‚Šã‚„ã™ã„ã¨æ€ã„ã¾ã™ï¼Kubernetesã¯è¤‡æ•°ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ãªã‚‹ä¸€ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’Podã¨ã„ã†å˜ä½ã§ç®¡ç†ã—ã¾ã™ï¼Docker-Compose â‰’ Podã¨è§£é‡ˆã—ã¦é ‚ã„ã¦ã„ã„ã¨æ€ã„ã¾ã™ï¼é¡Œæhttps://github.com/tozastation/gRPC-Training-Golangã‚’ä½¿ã£ã¦èª¬æ˜ã—ã¦ã„ãã¾ã™ï¼Docker-ComposeDBã¨APIã‚µãƒ¼ãƒã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã¨ã™ã‚‹ï¼ã„ã¤ã‚‚ãªã‚‰ã“ã‚“ãªæ„Ÿã˜ã ã¨æ€ã„ã¾ã™ï¼version: '3'services:    db:      build: ./mssql_container      ports:        - 1433:1433      environment:        - ACCEPT_EULA=Y        - SA_PASSWORD=Test@1234        - MSSQL_PID=Express        - MSSQL_LCID=1041        - MSSQL_COLLATION=Japanese_CI_AS      volumes:        - ./mssql_container/sql:/init-data        - ./mssql_container/start-up.sh:/start-up.sh      command: \"sh -c '/start-up.sh & /opt/mssql/bin/sqlservr;'\"    api:      build: .      stdin_open: true      tty: true      ports:        - 3001:3001Pod(Kubernetes)ä¸€æ–¹Kubernetesã§ã™ã¨ã“ã†æ›¸ãã¾ã™ï¼Deployment(deployment.yaml)Deploymentã®è²¬å‹™ã¯ï¼ŒPodã‚’ç¶­æŒã™ã‚‹ã“ã¨åŠã³ãƒ‡ãƒ—ãƒ­ã‚¤ã®ç®¡ç†ã§ã™ï¼apiVersion: extensions/v1beta1kind: Deployment # Kubernetesã®ã©ã®APIã‚’ä½¿ç”¨ã™ã‚‹ã‹æŒ‡å®šmetadata:   name: tozastation-grpc  namespace: tozastation # tozastationã¨ã„ã†åå‰ç©ºé–“ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æŒ‡å®š(è©³ç´°ã¯ã‚ã¨ã«è¨˜è¼‰)spec:ã€€ # ReplicaSetã¨ã„ã†ï¼Œè¨­å®šã—ãŸPodæ•°ã‚’ç¶­æŒã™ã‚‹(è² è·åˆ†æ•£)  replicas: 1ã€€  template:    metadata:      labels: # æ¤œç´¢ãŒå®¹æ˜“ã«ãªã‚‹ã‚ˆã†ã«ãƒ©ãƒ™ãƒ«ä»˜ã‘        app: tozastation-grpcã€€# kubectl get pods -l tozastation-grpc ã¿ãŸã„ã«ä½¿ã†    # Podã®ä¸­èº«ã‚’è¨­å®šã—ã¦ã„ã    spec:      containers:        - name: grpc-serverã€€# Podã®åå‰          image: tozastation/grpc_training_golang:latestã€€# Podã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ‘ã‚¹          ports: # Exposeã™ã‚‹ãƒãƒ¼ãƒˆ            - containerPort: 3001        - name: mssql          image: microsoft/mssql-server-linux:latest          ports:            - containerPort: 1433          env: # ç’°å¢ƒå¤‰æ•°            - name: ACCEPT_EULA              value: Y            - name: SA_PASSWORD              value: Test@1234            - name: MSSQL_PID              value: Express            - name: MSSQL_LCID              value: 1041            - name: MSSQL_COLLATION              value: Japanese_CI_AS         command: [\"sh\"]ã€€# ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•æ™‚ã«å‘¼ã³å‡ºã•ã‚Œã‚‹Shellã‚³ãƒãƒ³ãƒ‰         args: [\"-c\", \"'/start-up.sh & /opt/mssql/bin/sqlservr;'\"]Service(service.yaml)Serviceã®è²¬å‹™ã¯ï¼ŒDeployment(Pod)ã‚’ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å…¬é–‹ã™ã‚‹ã“ã¨ã§ã™ï¼apiVersion: v1kind: Servicemetadata:  labels:     name: tozastation-grpc  name: tozastation-servicespec:  clusterIP: None # Serviceã®ç¨®é¡ã‚’æŒ‡å®šã—ã¾ã™ï¼(è©³ç´°ã¯ã‚ã¨ã«è¨˜è¼‰)  ports:    - name: tozastation-grpc # Portã®åå‰      port: 3001 # å¤–ã«è¦‹ã›ã‚‹å ´åˆã®Portç•ªå·      protocol: TCP # ãƒ—ãƒ­ãƒˆã‚³ãƒ«      targetPort: 3001 # ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹Podã®ãƒãƒ¼ãƒˆç•ªå·  selector:    app: tozastation-grpc # ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹Podã®åå‰Namespace(åå‰ç©ºé–“ã«ã¤ã„ã¦)Kubernetesã¯ï¼Œã‚¯ãƒ©ã‚¹ã‚¿å†…ã§éš”é›¢ã•ã‚ŒãŸç’°å¢ƒã‚’å†ç¾ã™ã‚‹ãŸã‚ã«ï¼Œåå‰ç©ºé–“ã¨ã„ã†APIã‚’æŒã£ã¦ã„ã¾ã™ï¼ã“ã‚ŒãŒã§ãã‚‹ã¨ï¼Œã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã®Stagingç’°å¢ƒã¯ã‚ãã“ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ã„ã†æ„Ÿã˜ã§å®šç¾©ã§ãã¾ã™ï¼apiVersion: v1kind: Namespacemetadata:  name: tozastation-stagServiceã®ç¨®é¡ClusterIPå†…éƒ¨ã®ã‚¯ãƒ©ã‚¹ã‚¿å‘ã‘ã«å…¬é–‹ã—ã¾ã™ï¼clusterIP: 10.0.100.80HeadLess Serviceé€šå¸¸ï¼ŒPodã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸéš›ã®è² è·åˆ†æ•£ã¯ï¼ŒVIPãŒå‰²ã‚ŠæŒ¯ã‚‰ã‚Œè¡Œã‚ã‚Œã¾ã™ï¼ã—ã‹ã—ï¼ŒgRPCé€šä¿¡ãªã©ã¯ï¼Œã“ã‚Œã ã¨ã†ã¾ãåˆ†æ•£ã•ã‚Œãªã„ãªã©ã®ç¾çŠ¶ãŒã‚ã‚Šã¾ã™ï¼Podã®IPã¯å…¨ã¦ã“ã¡ã‚‰ã§çŸ¥ã£ã¦ãŠããŸã„ãªã©ã®å ´åˆã«ã“ã‚Œã‚’ç”¨ã„ã¾ã™ï¼clusterIP: NoneNodePortå…¨ã¦ã®Kubernetes Nodeã®IP:Portã§å—ã‘ãŸãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ã‚³ãƒ³ãƒ†ãƒŠã«è»¢é€ã™ã‚‹å½¢ã§ã€å¤–éƒ¨ç–é€šæ€§ã‚’ç¢ºç«‹ã—ã¾ã™Kubernetesã®Discoveryï¼†LBãƒªã‚½ãƒ¼ã‚¹ï¼ˆãã®1ï¼‰type: NodePortports:  - name: \"http-port\"    protocol: \"TCP\"    port: 8080    targetPort: 80    nodePort: 30080LoadBalancerã‚°ãƒ­ãƒ¼ãƒãƒ«IPã‚’ç™ºè¡Œã—ã¦ãã‚Œã‚‹(ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ™ãƒ³ãƒ€ãƒ¼ã§ä¸»ã«åˆ©ç”¨å¯èƒ½)type: LoadBalanceræœ€å¾Œã«ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã§å®Ÿè¡Œã™ã‚Œã°ãŠã—ã¾ã„ã§ã™ï¼kubectl apply -f [è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹]ã¾ã¨ã‚ã¡ã‚‡ã£ã¨ã—ãŸAPIã‚µãƒ¼ãƒã‚’Kubernetesã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ‰‹é †ã‚’æ›¸ã‹ã›ã¦ã„ãŸã ã„ãã¾ã—ãŸï¼å°‘ã—ã§ã‚‚èˆˆå‘³ã‚’æŒã£ã¦ã‚‚ã‚‰ã„çŸ¥è­˜å…±æœ‰ãŒã§ããŸã‚‰ãªã¨æ€ã„ã¾ã™ï¼","link":"https://qiita.com/tozastation/items/e4f77a96707b4e1fdf2d","isoDate":"2019-03-11T02:43:55.000Z","dateMiliSeconds":1552272235000,"authorName":"tozastation","authorId":"tozastation"},{"title":"Dockerfileã®æ›¸ãæ–¹ ~Multi Stage Build~","contentSnippet":"Dockerfileã¨ã¯Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä¸­èº«ã‚’å®šç¾©ã™ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã‚Šã¾ã™ï¼Vagrantã‚’åˆ©ç”¨ã—ãŸæ–¹ãŒã‚ã‚‹æ–¹ã¯ï¼ŒVagrantfileã‚’æ€ã„å‡ºã—ã¦é ‚ãã¨ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ã„ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ï¼é¡Œæhttps://github.com/tozastation/gRPC-Training-Golangã‚’ä½¿ã£ã¦èª¬æ˜ã—ã¦ã„ãã¾ã™ï¼APIã‚µãƒ¼ãƒã®ã‚¤ãƒ¡ãƒ¼ã‚¸ä½œã‚Šã§ã™ï¼Dockerfileã«è¨˜è¼‰ã™ã‚‹æµã‚Œãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æŒ‡å®šãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å‹•ä½œã™ã‚‹ã®ã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å°å…¥ãƒãƒ¼ãƒˆé–‹æ”¾ãƒ—ãƒ­ã‚°ãƒ©ãƒ èµ·å‹•ã‚³ãƒãƒ³ãƒ‰Dockerfile(Multi Stage Build)ä»¥ä¸‹Dockerfileã®ä¾‹ã«ãªã‚Šã¾ã™ï¼FROMãŒ2ç®‡æ‰€ã‚ã‚‹ã¨æ€ã„ã¾ã™ï¼ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ï¼’å€‹å–å¾—ã—ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ãŒï¼Œã“ã‚Œã«ã¯ç†ç”±ãŒã‚ã‚Šã¾ã™ï¼golang:latestã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä¸­ã«ã¯Goã®å®Ÿè¡Œç’°å¢ƒãŒå…¥ã£ã¦ã‚‹è¨³ã ãŒï¼Œã“ã‚ŒãŒ772MBã¨ã„ã†ã‚µã‚¤ã‚ºã‚’è¦ã™ã‚‹ï¼ä»Šå¾Œï¼Œã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒã‚³ãƒã‚³ç«‹ã¦ã¦è¡Œãã¨ãªã‚‹ã¨ï¼Œãªã‚‹ã¹ãèµ·å‹•ã‚’è»½é‡åŒ–ã—ãŸã„ã¨ãªã‚‹ã¨æ€ã„ã¾ã™ï¼ãã“ã§ï¼ŒMulti Stage Buildã§ã™ï¼# Build ContainerFROM golang:latest as builderWORKDIR /go/src/github.com/tozastation/gRPC-Training-GolangCOPY . .# Set Environment VariableENV CGO_ENABLED=0ENV GOOS=linuxENV GOARCH=amd64# BuildRUN go build -o app main.go# Runtime ContainerFROM alpineRUN apk add --no-cache ca-certificatesCOPY --from=builder /go/src/github.com/tozastation/gRPC-Training-Golang/app /appENV CONNECTION_STRING=Data Source=127.0.0.1:1433;Initial Catalog=Weather;User ID=SA;Password=Test@1234ENV VENDER=mssqlENV OPENWEATHER_URL=http://api.openweathermap.org/data/2.5/weatherENV OPENWEATHER_CREDENTIAL=&APPID=1e16e8941ce99bdd844d129d5179d98aEXPOSE 3001ENTRYPOINT [\"/app\"]Multi Stage Buildã“ã‚Œã¯ï¼Œãƒ“ãƒ«ãƒ‰ç’°å¢ƒã‹ã‚‰æˆæœç‰©ã‚’ç”Ÿæˆã—ï¼Œå®Ÿè¡Œã«å¿…è¦ãªæˆæœç‰©ã®ã¿ã‚’è¶…è»½é‡ã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ç§»ã™ã“ã¨ã§ï¼ŒDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®å®¹é‡ã‚’æœ€å°é™ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼å…ˆã»ã©ã®golang:latestã¯772MBã§ã—ãŸãŒï¼Œä»Šå›ä½œæˆã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã¯21.2MBã«ãªã‚Šã¾ã™ï¼åœ§å€’çš„ã§ã™ã­ï¼Goè¨€èªã¨ã®ç›¸æ€§Goã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯ï¼Œã‚·ãƒ³ã‚°ãƒ«ãƒã‚¤ãƒŠãƒªã«ãªã‚Šã¾ã™ï¼æ’å‡ºã•ã‚Œã‚‹1ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚’é‹ã¹ã°ï¼Œå®Ÿè¡Œå¯èƒ½ãªç’°å¢ƒãŒæ•´ã„ã¾ã™ï¼Runtimeç”¨ã®ç‰¹æ®Šãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ã‚‚ãªãï¼Œalpineã¨ã„ã†è»½é‡ãªLinuxã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã¿ã§å‹•ãã¾ã™ï¼Dockerã¨ã®ç›¸æ€§ã‚‚ãƒãƒƒãƒãƒªæ›¸ãæ–¹(ã‚„ã£ã¨)åŸºæœ¬çš„ãªDockerfileã®æ§‹æ–‡ã¯ï¼Œä»¥ä¸‹ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ã¿ã§ã™ï¼Linuxç’°å¢ƒã‚’Shellã‚³ãƒãƒ³ãƒ‰ã§æ•´ãˆãŸã“ã¨ãŒã‚ã‚‹æ–¹ã¯ã™ã‚“ãªã‚Šã„ã‘ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼ä½¿ã„ãã†ãªé †ã«æ›¸ã„ã¦ã„ã¾ã™ï¼å¤§ä½“ã“ã‚Œã§ä½œã‚Œã‚‹ã®ã§ï¼Œä»–ã«ã‚‚çŸ¥ã‚ŠãŸã„æ–¹ã¯å…¬å¼ã‚µã‚¤ãƒˆã‚’å‚ç…§ãã ã•ã„ï¼FROM ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã®å–å¾—# FROM golang:latest WORKDIR ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æŒ‡å®š(å­˜åœ¨ã—ãªã„å ´åˆã¯è‡ªå‹•ã§ä½œã‚Šã¾ã™ï¼)# WORKDIR /go/src/github.com/tozastation/gRPC-Training-GolangADD ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Dockerã‚¤ãƒ¡ãƒ¼ã‚¸å†…ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹(åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•è§£å‡ã•ã‚Œã‚‹)# ADD: . .COPY åŒä¸Š(åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•è§£å‡ã•ã‚Œãªã„)# COPY: . .RUN Shellã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œ# RUN apt-get install -y vimENV ç’°å¢ƒå¤‰æ•°ã‚’å®šç¾©# ENV PORT=3306EXPOSE é–‹æ”¾ã™ã‚‹ãƒãƒ¼ãƒˆç•ªå·# EXPOSE 3306ENTRYPOINT å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’æŒ‡å®š# ENTRYPOINT [\"/app\"]â€» Multi Stage Buildã§å¿…è¦ãªé …ç›®ã¯ï¼ŒFROMã‚’ãƒ“ãƒ«ãƒ‰ç”¨ã¨å®Ÿè¡Œç”¨ã§ï¼’ã¤ç”¨ã„ã‚‹äº‹ï¼Œå®Ÿè¡Œç”¨ã‚¤ãƒ¡ãƒ¼ã‚¸ã«æˆæœç‰©ã‚’COPYã§ç§»ã™ã“ã¨ãã‚‰ã„ã¨æ‰‹è»½ã«ã§ãã¾ã™ã®ã§èª¬æ˜ã¯å‰²æ„›ã—ã¾ã™ï¼","link":"https://qiita.com/tozastation/items/ca19034433f30ea5baee","isoDate":"2019-03-09T02:10:52.000Z","dateMiliSeconds":1552097452000,"authorName":"tozastation","authorId":"tozastation"},{"title":"kubectl ã‚³ãƒãƒ³ãƒ‰é›†","contentSnippet":"è‰¯ãä½¿ã†ã‚³ãƒãƒ³ãƒ‰ãŸã¡ãƒªã‚¹ãƒˆè¡¨ç¤ºPodkubectl get podsServicekubectl get svcãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰kubectl port-forward svc/ã‚µãƒ¼ãƒ“ã‚¹å ãƒãƒ¼ãƒˆç•ªå·:ãƒãƒ¼ãƒˆç•ªå·ä½œæˆPodkubectl apply -f ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹Namespacekubectl create namespace åå‰ç©ºé–“åæ¶ˆå»Podkubectl delete pod PodåPodå®Œå…¨æ¶ˆå»kubectl delete pods Podå --grace-period=0 --force","link":"https://qiita.com/tozastation/items/1ea437db7cfa2eea0965","isoDate":"2019-03-07T07:23:16.000Z","dateMiliSeconds":1551943396000,"authorName":"tozastation","authorId":"tozastation"},{"title":"Goã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£","contentSnippet":"ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯APIã‚µãƒ¼ãƒã‚’å®Ÿè£…ã™ã‚‹ã¨ãã¯ã ã„ãŸã„ä»¥ä¸‹ã®æµã‚Œã ã¨æ€ã„ã¾ã™ï¼ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã£ã¦ -> å‡¦ç†ã—ã¦ -> ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ç°¡å˜ã«è¨€ã†ã¨ï¼Œã“ã®æµã‚Œã‚’è²¬å‹™ã«ä¹—ã£å–ã‚Šåˆ†å‰²ã™ã‚‹ã“ã¨ã§ï¼Œä¾å­˜é–¢ä¿‚ã‚’å°‘ãªãã—ï¼Œãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®ã—ã‚„ã™ã„æ§‹æˆã«ã—ã‚ˆã†ã¨è¨€ã†è€ƒãˆæ–¹ã«ãªã‚Šã¾ã™ï¼æ§‹æˆUI(Presentation)å±¤: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã“ã¨ã‚’æŒ‡ã—ã¾ã™ï¼ APIã‚µãƒ¼ãƒã§ã¯è€ƒãˆã¾ã›ã‚“ï¼Applicationå±¤: Domainå±¤ã‚’ç”¨ã„ã¦ï¼Œã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒæ¬²ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ã®ãŒè²¬å‹™ã§ã™ï¼Domainå±¤: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹ã®ãŒè²¬å‹™ã§ã™ï¼Infrastructureå±¤: DBã¨ã®é€šä¿¡ãŒè²¬å‹™ã§ã™ï¼é¡Œæhttps://github.com/tozastation/gRPC-Training-Golangã‚’ä½¿ã£ã¦èª¬æ˜ã—ã¦ã„ãã¾ã™æ§‹æˆâ”œâ”€â”€ domain: ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤â”‚   â”œâ”€â”€ repository: ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡â”‚   â””â”€â”€ service: ãƒ­ã‚¸ãƒƒã‚¯â”œâ”€â”€ idl: Protocol Bufferã®å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«â”œâ”€â”€ implements: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤â”œâ”€â”€ infrastructure: ã‚¤ãƒ³ãƒ•ãƒ©å±¤â”‚   â””â”€â”€ persistenceâ”‚       â”œâ”€â”€ model: DBãƒ¢ãƒ‡ãƒ«â”‚       â””â”€â”€ mssql: mssqlã‚µãƒ¼ãƒç”¨Repositoryâ”œâ”€â”€ interfaces: ãã®ä»–â”‚   â”œâ”€â”€ auth: èªè¨¼â”‚   â”œâ”€â”€ di: ä¾å­˜æ€§ã®æ³¨å…¥â”‚   â”œâ”€â”€ handler: ãƒãƒ³ãƒ‰ãƒ©ãƒ¼â”‚   â””â”€â”€ rpc: gRPCç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«â”œâ”€â”€ main.goâ”œâ”€â”€ protoc.shâ””â”€â”€ vendor: Goã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤repositoryrepositoryã§ã¯ï¼Œã‚¤ãƒ³ãƒ•ãƒ©å±¤ã«ãŠã‘ã‚‹repositoryã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã™ï¼ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡(æŠ½è±¡ã«ä¾å­˜ã›ã‚ˆ)å…ˆã»ã©èª¬æ˜ã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã ã‘ã§ã¯å›°ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼ãã‚Œã¯ï¼Œä¸Šä½ãƒ¬ã‚¤ãƒ¤ãŒä¸‹ä½ãƒ¬ã‚¤ãƒ¤ã®å®Ÿä½“ã‚’æŒã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã§ã™ï¼ä¸‹ä½ãƒ¬ã‚¤ãƒ¤ã®å®Ÿè£…ãŒå¤‰æ›´ã•ã‚Œã‚‹ã¨ï¼Œä¸Šä½ãƒ¬ã‚¤ãƒ¤ã¯å½±éŸ¿ã‚’å—ã‘ã‚‹ã“ã¨ã‚„ï¼Œä¸Šä½ãƒ¬ã‚¤ãƒ¤ã¯ä¸‹ä½ãƒ¬ã‚¤ãƒ¤ã®å®Ÿè£…å¾Œã§ãªã„ã¨å‚ç…§ã§ããªã„ãªã©ã®ä¸ä¾¿ã•ãŒæ®‹ã‚Šã¾ã™ï¼ãã®ãŸã‚ï¼Œinterfaceã‚’ç”¨ã„ã¦ï¼ŒæŠ½è±¡ã«ä¾å­˜ã—ã¾ã™ï¼ã“ã‚Œã«ã‚ˆã‚Šï¼Œä¸Šä½ãƒ¬ã‚¤ãƒ¤ã¯ä¸‹ä½ãƒ¬ã‚¤ãƒ¤ã®è©³ç´°ã¯çŸ¥ã‚‰ãšã¨ã‚‚è‰¯ããªã‚Šã¾ã™ï¼å®Ÿè£…package repository// IUserRepository is ...type IUserRepository interface {    FindUserByUserToken(ctx context.Context, token string) (*db.User, error)    CreateUser(user *db.User) (string, error)    Login(uID string, password []byte) (string, error)}serviceå®Ÿè£…ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ãŒã‚µãƒ¼ãƒ“ã‚¹å±¤ã‚’å‚ç…§ã™ã‚‹ãŸã‚ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ï¼ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜ã—ãŸæ§‹é€ ä½“ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ï¼æ§‹é€ ä½“ã‚’ç”Ÿæˆã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¦ã„ã¾ã™(ã®ã¡ã«è§£èª¬ã—ã¾ã™ãŒã“ã‚ŒãŒDIã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ã™ï¼)å®šç¾©ã—ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«åˆã‚ã›ã¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ï¼package service// IUserService ...type IUserService interface {    GetMe(ctx context.Context, token string) (*rpc_user.GetUser, error)    SignIn(ctx context.Context, uID, password string) (string, error)    SignUp(ctx context.Context, user *rpc_user.PostUser) (string, error)}type userService struct {    irepo.IUserRepository}// NewUserService is ...func NewUserService(repo irepo.IUserRepository) IUserService {    return &userService{repo}}func (srv *userService) GetMe(ctx context.Context, token string) (*rpc_user.GetUser, error) {    user, err := srv.IUserRepository.FindUserByUserToken(ctx, token)    if err != nil {        return nil, err    }    return dbToPostUser(user), nil}func dbToPostUser(user *db.User) *rpc_user.GetUser {    return &rpc_user.GetUser{        Name:     user.Name,        CityName: user.CityName,    }}ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤implementå®Ÿè£…Applicationå±¤ãŒä¾å­˜ã™ã‚‹ã‚‚ã®ç„¡ããªã„ï¼Ÿã¨æ€ã‚ã‚Œã‚‹ã¨æ€ã„ã¾ã™ï¼ã“ã‚Œã¯Goã®ç‰¹å¾´ãªã®ã§ã™ãŒï¼ŒDIã‚’è¡Œã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ãŸéš›ã«ï¼Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¿”ã‚Šå€¤ã¨ã—ã¦å®Ÿè£…ã—ã¦ã„ã¾ã™ï¼ã“ã®ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ï¼Œå®šç¾©ã—ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å†…å®¹ã‚’æº€ãŸã•ãªã„ã¨é–¢æ•°ãŒå®Ÿè£…ã•ã‚ŒãŸã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒèªã‚ãªã„ãŸã‚ï¼Œã“ã®æ§‹é€ ä½“ã¯å®šç¾©ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å…¨ã¦å«ã‚“ã§ã„ã‚‹ã¨ã„ã†ã“ã¨ã‚’æ‹…ä¿ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼package implements// IUserImplement is ...type IUserImplement interface {    Get(ctx context.Context, p *rpc_user.GetRequest) (*rpc_user.GetResponse, error)    Login(ctx context.Context, p *rpc_user.LoginRequest) (*rpc_user.LoginResponse, error)    Post(ctx context.Context, p *rpc_user.PostRequest) (*rpc_user.PostResponse, error)}type userImplement struct {    isrv.IUserService    *logrus.Logger}// NewUserImplement is ...func NewUserImplement(s isrv.IUserService, l *logrus.Logger) IUserImplement {    return &userImplement{s, l}}func (imp *userImplement) Get(ctx context.Context, p *rpc_user.GetRequest) (*rpc_user.GetResponse, error) {    imp.Logger.Infoln(\"[START] GetMyBoughtVegetablesRPC is Called from Client\")    token := p.GetToken()    user, err := imp.IUserService.GetMe(ctx, token)    if err != nil {        return nil, err    }    res := rpc_user.GetResponse{        User: user,    }    imp.Logger.Infoln(\"[END] GetMyBoughtVegetablesRPC is Called from Client\")    return &res, nil}ã‚¤ãƒ³ãƒ•ãƒ©å±¤persistenceè²¬å‹™ã¯ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã§ã™modelå®Ÿè£…DBã«å—ã‘æ¸¡ã™ãƒ‡ãƒ¼ã‚¿ã‚’æ§‹é€ ä½“ã¨ã—ã¦å®šç¾©ã—ã¾ã™package db// User is ...type User struct {    BaseModel    Name        string    CityName    string    Password    []byte    AccessToken string}mssqlå®Ÿè£…ç‰¹å¾´ã¨ã—ã¦ã¯ï¼Œdatabase/sqlã‚’ç”¨ã„ã¦ï¼ŒSQLæ–‡ã‚’ç›´æ›¸ãã—ã¦ã„ã¾ã™ï¼ç†ç”±ã¨ã—ã¦ã¯ï¼Œormã¯ç‹¬è‡ªã®æ§‹æ–‡ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ä»–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä»¥é™ã«ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚Šã¾ã™ãŒï¼ŒSQLæ–‡ã ã¨æ±ç”¨æ€§ãŒã‚ã‚‹ãŸã‚ã§ã™ï¼package mssql// UserRepository istype UserRepository struct {    *sql.DB}// NewUserRepository is ...func NewUserRepository(Conn *sql.DB) irepo.IUserRepository {    return &UserRepository{Conn}}// FindUserByUserToken is ...func (repo *UserRepository) FindUserByUserToken(ctx context.Context, token string) (*db.User, error) {    dbUser := db.User{}    if err := repo.DB.QueryRow(\"SELECT CityName FROM [Weather].[dbo].[Users] WHERE AccessToken = \" + token).Scan(&dbUser.CityName); err != nil {        return nil, err    }    return &dbUser, nil}ãã®ä»–authJWT(Json Web Token)ã¨ã„ã†æŠ€è¡“ã‚’ç”¨ã„ã¦ã„ã¾ã™ï¼èˆˆå‘³ã‚ã‚‹æ–¹ã¯ã“ã¡ã‚‰ã‚’å‚ç…§diä¾å­˜æ€§æ³¨å…¥(Dependency Injection)å…ˆã»ã©ã‹ã‚‰DIDIã¨è¨€ã£ã¦ãã¾ã—ãŸãŒï¼ŒDIã¨ã¯å¤–éƒ¨ã‹ã‚‰ã‚¯ãƒ©ã‚¹ã‚’å°„ã—è¾¼ã‚€ã“ã¨ã‚’è¨€ã„ã¾ã™ï¼å®Ÿè£…ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¨ãã‚’è€ƒãˆã¦ã¿ã¦ãã ã•ã„ï¼ã‚µãƒ¼ãƒ“ã‚¹å±¤ã®ãƒ†ã‚¹ãƒˆã‚’ã™ã‚‹ã¨ãªã‚‹ã¨ï¼ŒDBã®æƒ…å ±ãŒæ¬²ã—ã„ã¨ãªã‚Šã¾ã™ï¼ã¨ãªã‚‹ã¨ãƒªãƒã‚¸ãƒˆãƒªãŒå¿…è¦ãã†ã§ã™ï¼ã—ã‹ã—ã“ã‚Œã§ã¯ï¼ŒDBã«ä¾å­˜ã—ã¦ã—ã¾ã„åˆ‡ã‚Šåˆ†ã‘ãŸæ„å‘³ãŒãªããªã£ã¦ã—ã¾ã„ã¾ã™ï¼DIã‚’ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šï¼Œæ±ºã¾ã£ãŸå€¤ã‚’è¿”ã™ãƒ¢ãƒƒã‚¯ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ãŒã§ãï¼Œæ™´ã‚Œã¦ä¾å­˜æ€§ã‚’è§£æ¶ˆã§ãã‚‹ã¨ã„ã†è¨³ã§ã™ï¼package divar logger = logrus.New()// InitializeUser is ...func InitializeUser() implements.IUserImplement {    repo := mssql.NewUserRepository(handler.OpenDBConnection())    srv := service.NewUserService(repo)    imp := implements.NewUserImplement(srv, logger)    return imp}handlerDBãªã©ã®ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é›†ã‚ã¦ã„ã¾ã™ï¼rpcgRPCã®èª¬æ˜ã¯å¾Œã«å›ã—ã¾ã™","link":"https://qiita.com/tozastation/items/a69a102fdc3f62d566b4","isoDate":"2019-03-07T04:55:32.000Z","dateMiliSeconds":1551934532000,"authorName":"tozastation","authorId":"tozastation"},{"title":"[å…¥é–€] Goã§APIã‚’æ›¸ã„ã¦ï¼Œk8sã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¾ã§ [éšæ™‚æ›´æ–°]","contentSnippet":"æ¦‚è¦æ–°ã—ã„æŠ€è¡“ã‚’ä½¿ã£ã¦ã¿ãŸã„ã‘ã©ï¼Œ ä½•ãŒã„ã„ã®ï¼Ÿã©ã†ä½¿ã†ã®ï¼Ÿæ™‚é–“ãªã„ã‚ˆ ã¨èºŠèº‡ã—ã¦ã—ã¾ã†ã“ã¨ã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™ï¼æœ¬è¨˜äº‹ã§ã¯ï¼Œè‡ªåˆ†ãŒèº“ã„ãŸãƒã‚¤ãƒ³ãƒˆã‚‚è¸ã¾ãˆã¤ã¤é¡Œæã‚’å…ƒã«ã‚¬ã‚·ã‚¬ã‚·æ›¸ã„ã¦ã„ã“ã†ã‹ãªã¨æ€ã„ã¾ã™ï¼è‡ªåˆ†è‡ªèº«ã‚‚æœ€è¿‘å­¦ã³å§‹ã‚ãŸæŠ€è¡“ã§ã™ã®ã§ï¼Œå…¥é–€ã¨ã—ã¦æ›¸ã‹ã›ã¦ã„ãŸã ãã¾ã™ï¼æ§‹æˆGoç·¨Goã¨ã¯ Goã§ï¼Œãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ›¸ã„ã¦ã¿ã‚‹Goã§gRPCã‚’ä½¿ã£ã¦ã¿ã‚‹(ãŠå¾…ã¡ä¸‹ã•ã„ğŸ˜“)Goã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã“ã†(ãŠå¾…ã¡ä¸‹ã•ã„ğŸ˜“)Dockerç·¨Dockerã¨ã¯(ãŠå¾…ã¡ä¸‹ã•ã„ğŸ˜“)Dockerfileã®æ›¸ãæ–¹Dockerã®ä½¿ã„æ–¹(ãŠå¾…ã¡ä¸‹ã•ã„ğŸ˜“)Kubernetes(k8s)ç·¨Kubernetes(k8s)ã¨ã¯ (ãŠå¾…ã¡ä¸‹ã•ã„ğŸ˜“)k8sã«APIã‚µãƒ¼ãƒã‚’ãƒ‡ãƒ—ãƒ­ã‚¤kubectlã‚³ãƒãƒ³ãƒ‰ãƒ­ã‚°ã®åé›† (ãŠå¾…ã¡ä¸‹ã•ã„ğŸ˜“)Istio on KubernetesIstioãŒä½œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥~ç’°å¢ƒæ§‹ç¯‰~IstioãŒä½œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥~ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤~","link":"https://qiita.com/tozastation/items/e259c6d94a32e5c721e4","isoDate":"2019-03-07T03:05:34.000Z","dateMiliSeconds":1551927934000,"authorName":"tozastation","authorId":"tozastation"},{"title":"[å…¥é–€] Goã¨ã¯ [éšæ™‚æ›´æ–°äºˆå®š]","contentSnippet":"Goã«ã¤ã„ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªGoã®æƒ…å ±ã‚µã‚¤ãƒˆã§ã‚ã‚‹golang.jpã•ã‚“ã«æ›¸ã„ã¦ã„ã¾ã™ï¼Googleã•ã‚“ãŒç™ºè¡¨ã—ãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«ãªã‚Šã¾ã™ï¼è‡ªåˆ†ãŒç‰¹ã«æŠœç²‹ã™ã‚‹ãªã‚‰ã°ï¼Œä»¥ä¸‹ã®äºŒç‚¹ã«ãªã‚Šã¾ã™ï¼ã‚·ãƒ³ãƒ—ãƒ«ã•å¤§è¦æ¨¡ãªã‚·ã‚¹ãƒ†ãƒ ã«ãŠã„ã¦ï¼Œå±äººæ€§ï¼ˆå€‹ã®æŠ€è¡“ã‚¹ã‚­ãƒ«ï¼‰ã«ã‚ˆã‚‹è¤‡é›‘ãªå®Ÿè£…ã¯ï¼Œé‹ç”¨ã‚„ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚’é›£ã—ãã•ã›ã¾ã™ï¼Goã«ã¯ï¼Œç¶™æ‰¿ãƒ»Genericsãƒ»ä¾‹å¤–ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“(å‚è€ƒè¨˜äº‹)ï¼ã¾ãŸï¼Œãƒ«ãƒ¼ãƒ—å‡¦ç†ã‚’ä¾‹ã«ã‚ã’ã‚‹ã¨ï¼Œä»–ã®è¨€èªã ã¨forãƒ» whileãƒ»do/whileãªã©é¸æŠè‚¢ãŒã‚ã‚Šã¾ã™ãŒï¼ŒGoã§ã¯ï¼Œforã—ã‹å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼ã“ã®ã‚ˆã†ã«ï¼Œãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã«ã‚ˆã‚‹è¡¨ç¾ã®é•ã„ã‚’æŠ‘åˆ¶ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã“ã®ã“ã¨ã‹ã‚‰ï¼Œåˆå­¦è€…ã§ã‚‚å–ã£ã¤ãã‚„ã™ã„ã¨æ€ã£ã¦ã„ã¾ã™ï¼è‡ªåˆ†ã‚’ä¾‹ã«å‡ºã™ã¨ï¼ŒAPIã‚µãƒ¼ãƒã‚’ä½œã‚ã†ã¨ãªã£ãŸæ™‚ã«ï¼ŒJava, Scala->Pythonãªã©ã‚’å­¦ã‚“ã§ãã¾ã—ãŸãŒï¼Œ Goã®å­¦ç¿’ã‚³ã‚¹ãƒˆã®æ–¹ãŒä½ã„ã§ã™ã—ï¼Œãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãŒä¸ŠãŒã‚Šã¾ã—ãŸï¼ã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹ç™ºã—ã¦ã„ã‚‹æ–¹é”ã§ã‚‚ï¼Œå¤šäººæ•°ã§ç²¾åº¦ã‚„ã°ã‚‰ã¤ãã‚’ç¶­æŒã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ç”Ÿç”£ã—ã¦ã„ãã®ã¯é›£ã—ã„ã¨æ€ã„ã¾ã™ï¼ˆãƒšã‚¢ãƒ—ãƒ­ã‚„ãƒ¢ãƒ–ãƒ—ãƒ­ã‚‚ã‚ã‚Šã¾ã™ãŒï¼‰ï¼é«˜é€Ÿã•é–‹ç™ºã«ãŠã„ã¦ï¼Œé€Ÿåº¦ã¯é‡è¦ã§ã™ï¼ã“ã“ã§ã„ã†é–‹ç™ºé€Ÿåº¦ã¯ï¼Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã§ã¯ãªãï¼Œãƒãƒ¼ãƒ ã¨ã—ã¦ã®é–‹ç™ºé€Ÿåº¦ã«ãªã‚Šã¾ã™ï¼ç‰¹ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ“ãƒ«ãƒ‰æ™‚é–“ã¯ç‰¹ã«é‡è¦ã§ã‚ã‚‹ã¨è€ƒãˆã¦ã„ã¾ã™ï¼å®Ÿè£…ã—ãŸã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹ç™ºç’°å¢ƒã‚„ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§å‹•ã‹ã—ãŸã„ã“ã¨ã‚’è€ƒãˆã¦ã¿ã¦ä¸‹ã•ã„ï¼çµŒé¨“ã—ãŸæ–¹ã‚‚ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒï¼Œè¦æ¨¡ã®å¤§ããªã‚·ã‚¹ãƒ†ãƒ ã«ãªã‚‹ç¨‹ãƒ“ãƒ«ãƒ‰æ™‚é–“ã¯ã‚‚ã®ã™ã”ã„é‡ã«ãªã‚Šã¾ã™ï¼ä¸‹è¨˜ã¯ï¼ŒC#ã¨Goã§åŒæ§˜ã®å‡¦ç†ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãï¼Œãƒ“ãƒ«ãƒ‰ã‚’è¡Œãªã£ãŸçµæœã§ã™ï¼C#ã‚‚ã‚‚ã¡ã‚ã‚“å¥½ãã§ã™çµæœC#ã®2åˆ†ã®1ã»ã©ã®é€Ÿåº¦ã§å®Ÿç¾ã§ãã¦ã„ã¾ã™ï¼- C#: ç´„447ç§’- Go: ç´„200ç§’ã¾ã¨ã‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’åˆã‚ã¦3å¹´ã»ã©çµŒã¡ï¼Œãƒãƒ¼ãƒ é–‹ç™ºã‚’ä½•åº¦ã‹çµŒé¨“ã—ã¦ã¿ã¦Goã¯ã„ã„ãªã¨æ€ã£ãŸã®ã§æœ¬è¨˜äº‹ã‚’æ›¸ã‹ã›ã¦ã„ãŸã ãã¾ã—ãŸï¼èˆˆå‘³ã®ã‚ã‚‹æ–¹ã¯ãœã²è©¦ã—ã¦ã¿ã¦ä¸‹ã•ã„ï¼","link":"https://qiita.com/tozastation/items/029440f6471d3ab97b8c","isoDate":"2019-03-07T03:02:58.000Z","dateMiliSeconds":1551927778000,"authorName":"tozastation","authorId":"tozastation"},{"title":"k8sã§ã€HTTP/2(gRPCã‚µãƒ¼ãƒ)ã‚’è² è·åˆ†æ•£ã—ãŸã„","contentSnippet":"kubernetesã§ã€HTTP/2ã‚’è² è·åˆ†æ•£ã—ã¦ã¿ãŸã¯ã˜ã‚ã«èƒŒæ™¯ç¾åœ¨å­¦ç”Ÿãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚¤ãƒ³ãƒ•ãƒ©ã¨ã—ã¦ã€GKE(Google Kubernetes Engine)ã‚’åˆ©ç”¨ã•ã›ã¦é ‚ã„ã¦ã„ã¾ã™ã€‚REST APIã‚µãƒ¼ãƒã‚’ã€gRPCã«æ›è£…ã—ã¦ã¿ã‚ˆã†ã¨ã—ãŸæ™‚ã«ã‚ã‚‹å•é¡Œã«ã¶ã¡å½“ãŸã‚Šã¾ã—ãŸã€‚å‰æçŸ¥è­˜ã¨ã—ã¦Kubernetesã®ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µServices are a â€œlayer 4â€ (TCP/UDP over IP) construct, the proxy was purely in userspaceç¾è¡Œã®Kubernetesã®Ingressã¯ã€OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤(L4)ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚(betaç‰ˆã¯ãã®é™ã‚Šã§ã¯ãªã„ã§ã™ï¼)gRPCã®é€šä¿¡ã®ä»•æ–¹gRPCã§ã®é€šä¿¡ã¯ã€ ä¸€ã¤ã®TCPã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã„å›ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãŒç¢ºç«‹ã—ã¦ã„ã‚‹é–“ã¯ã‚µãƒ¼ãƒã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ç¹‹ãŒã‚Šç¶šã‘ã¾ã™ã€‚å•é¡Œã¨ã¯gRPC is a modern RPC protocol implemented on top of HTTP/2. HTTP/2 is a Layer 7 (Application layer) protocol (å‚ç…§: å…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Š)ã¨ã„ã†ã‚ˆã†ã«ã€gRPCã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤(L7)ã§å‹•ä½œã™ã‚‹ã®ã§ã™ã€‚ã¤ã¾ã‚Šã€L4ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µã§ã¯ã€ é©åˆ‡ã«è² è·åˆ†æ•£ã§ããªã„å ´åˆ ãŒã‚ã‚‹ã®ã§ã™ï¼Ingreesä½¿ãˆãªã„ã˜ã‚ƒã‚“ï¼Envoyã«å‡ºä¼šã„ã¾ã—ãŸL7 LoadBalancerã¨èª¿ã¹ã¦ã„ãŸã‚‰è¨˜äº‹ãŒè¦‹ã¤ã‹ã£ã¦æ¥ã¾ã—ãŸã€‚ref:  kubernetesã§gRPCã™ã‚‹ã¨ãã«envoyæŒŸã‚“ã§ã¿ãŸã‚ˆEnvoyã¨ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–å‘ã‘ã¤ã¾ã‚Šãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å‘ã‘ã®Proxyã¨ã—ã¦è¨­è¨ˆã•ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ã‚½ãƒ•ãƒˆã§ã™ã€‚L7ãƒ—ãƒ­ã‚­ã‚·ã‚‚ã‚‚ã¡ã‚ã‚“å¯¾å¿œã§ã™ï¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ã¯æ—©é€Ÿå°å…¥ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼æµã‚Œã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚1. gRPCã‚µãƒ¼ãƒã®Serviceã‚’Load Balancerã‹ã‚‰Headless Serviceã«ã™ã‚‹2. Envoyã‚’ã‚¯ãƒ©ã‚¹ã‚¿ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—å¤–éƒ¨å…¬é–‹gRPCã‚µãƒ¼ãƒã®Serviceã‚’Load Balancerã‹ã‚‰Headless Serviceã«ã™ã‚‹Envoyã®ã‚³ãƒ³ãƒ•ã‚£ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã‚“ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã™ã€‚apiVersion: v1kind: ConfigMapmetadata:  name: \"envoy-config\"data:  envoy.json: |    {      \"listeners\": [        {          \"address\": \"tcp://0.0.0.0:15001\",          \"filters\": [            {              \"type\": \"read\",              \"name\": \"http_connection_manager\",              \"config\": {                \"codec_type\": \"auto\",                \"stat_prefix\": \"ingress_http\",                \"route_config\": {                  \"virtual_hosts\": [                    {                      \"name\": \"service\",                      \"domains\": [\"*\"],                      \"routes\": [                        {                          \"timeout_ms\": 0,                          \"prefix\": \"/\",                          \"cluster\": \"\"                        }                      ]                    }                  ]                },                \"filters\": [                  {                    \"type\": \"decoder\",                    \"name\": \"router\",                    \"config\": {}                  }                ]              }            }          ]        }      ],      \"admin\": {       \"access_log_path\": \"/dev/stdout\",       \"address\": \"tcp://127.0.0.1:8001\"      },      \"cluster_manager\": {        \"clusters\": [          {            \"name\": \"rakusale-grpc\",            \"features\": \"http2\",            \"connect_timeout_ms\": 250,            \"type\": \"strict_dns\",            \"lb_type\": \"round_robin\",            \"hosts\": [{\"url\": \"tcp://Hostå:Portç•ªå·\"}]         }        ]      }    }æ³¨ç›®ã—ã¦æ¬²ã—ã„ã¨ã“ã‚ã¯ã“ã“ã§ã™ï¼\"cluster_manager\": {        \"clusters\": [          {            \"name\": \"rakusale-grpc\",            \"features\": \"http2\",            \"connect_timeout_ms\": 250,            \"type\": \"strict_dns\",            \"lb_type\": \"round_robin\",            \"hosts\": [{\"url\": \"tcp://Hostå:Portç•ªå·\"}]         }        ]      }clusters[\"hosts\"]ã®ã¨ã“ã‚ã«ã€ã‚µãƒ¼ãƒå´ã®IPã¨ãƒãƒ¼ãƒˆã‚’æŒ‡å®šã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€Envoyå´ãŒè² è·åˆ†æ•£ã™ã‚‹ãŸã‚ã«Podã®IPã‚’çŸ¥ã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã“ã§ã€Headless ServiceHeadless Serviceã¯ã€Serviceã«å¯¾ã—ã¦DNSãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã¨Podã®IPã‚’è¿”ã—ã¦ãã‚Œã‚‹ã‚‚ã®ã§ã™ã€‚å‹•ã‹ã—ãŸã„ã‚µãƒ¼ãƒã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ã“ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚apiVersion: v1kind: Servicemetadata:  labels:     name: \"\"  name: \"\"spec:  clusterIP: None  ports:    - name: \"\"      port: 3001      protocol: TCP      targetPort: 3001  selector:    app: \"\"ClusterIP: Noneã¨ã™ã‚‹ã ã‘ã§ã€Headless Serviceã«ãªã‚Šã¾ã™ï¼Envoyã‚’ã‚¯ãƒ©ã‚¹ã‚¿ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—å¤–éƒ¨å…¬é–‹å¿…è¦ãªã‚‚ã®ã¯3ã¤ã§ã™ã€‚- envoy_configmap.yaml : ã•ã£ãç´¹ä»‹ã—ã¦ã„ã¾ã™ï¼- envoy_deployment.yaml- envoy_service.yamlenvoy_deployment.yamlapiVersion: extensions/v1beta1kind: Deploymentmetadata:  name: \"envoy\"spec:  replicas: 2  template:    metadata:      labels:        app: \"envoy\"    spec:      volumes:        - name: envoy          configMap:            name: \"envoy-config\"        # - name: tls        #   secret:        #     secretName: tlssecret      containers:        - name: envoy          image: envoyproxy/envoy:6e3633496f5a9412abdca8bac7db6b701ae8ce14          command:            - \"/usr/local/bin/envoy\"          args:            - \"--config-path /etc/envoy/envoy.json\"          resources:            limits:              memory: 512Mi          ports:            - containerPort: 15001              name: app            - containerPort: 8001              name: envoy-admin          volumeMounts:            - name: envoy              mountPath: /etc/envoy            # - name: tls            #   mountPath: /etc/tlssecret            #   readOnly: trueenvoy_service.yamlapiVersion: v1kind: Servicemetadata:  labels:    name: \"envoy\"  name: \"envoy-service\"spec:  type: LoadBalancer  selector:    app: \"envoy\"  ports:    - name: tcp      port: 15001      targetPort: 15001ä»¥ä¸Šã‚’ç”¨æ„ã—ã¦ kubectl apply ã—ã¦GIPã«æ¥ç¶šã™ã‚Œã°ã€è² è·åˆ†æ•£ãŒå®Œæˆã—ã¦ã„ã‚‹ã¯ãšã§ã™ï¼çµ‚ã‚ã‚Šã«Kubernetesã‚¯ãƒ©ã‚¹ã‚¿å†…ã®ãƒ‘ã‚±ãƒƒãƒˆã¨ã‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§è‰¯ã„ã®ãŒã‚ã£ãŸã‚‰æ•™ãˆã¦æ¬²ã—ã„ã§ã™ï¼ã‚ã¨ã€gRPCã‚µãƒ¼ãƒæ›¸ãæ™‚ã«ãƒ­ã‚°ã‚’ãã¡ã‚“ã¨æ›¸ãå®Ÿè£…ã«ã—ãªã„ã¨å¿ƒåº•ä¸ä¾¿ã ãªã¨æ€ã„ã¾ã—ãŸã€ã€ã€ã„ã¤ã‚‚ã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒã‚„ã£ã¦ãã‚Œã¦ã„ãŸã®ã§ã€ã€ã€ä»Šå¾Œã‚‚ç²¾é€²ã—ã¦ã„ãã¾ã™","link":"https://qiita.com/tozastation/items/37c593b91c788e1f306d","isoDate":"2019-02-06T06:58:15.000Z","dateMiliSeconds":1549436295000,"authorName":"tozastation","authorId":"tozastation"},{"title":"C#ã§gRPCã‚µãƒ¼ãƒã‚’å®Ÿè£…ã—ã¦ã¿ãŸ","contentSnippet":"C#ã§gRPCã‚µãƒ¼ãƒã‚’å®Ÿè£…ã—ã¦ã¿ãŸã¯ã˜ã‚ã«èƒŒæ™¯å­¦ç”Ÿã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€ Apiaryã‚„Swaggerãªã©ã®APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã‚’ç”¨ã„ã¦ã„ãŸãŒã€è¦æ¨¡ãŒå¤§ãããªã‚‹ã«é€£ã‚Œã¦ç·¨é›†ãŒé¢å€’ã ãªã€œã¨æ„Ÿã˜ã¦ã„ãŸã€‚â†“ã“ã‚“ãªæ„Ÿã˜ã®yamlã‚’æ›¸ãç¶šã‘ã‚‹ ãã†æ€ã£ã¦ãŸæ™‚ã«å‡ºä¼šã£ãŸã®ãŒgRPCã§ã‚ã‚‹ã€‚gRPCã¨ã¯gRPCã¯ã€RPC (Remote Procedure Call) ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«GoogleãŒé–‹ç™ºã—ãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®1ã¤ã§ã™ã€‚Protocol Buffers ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ã€é«˜é€Ÿãªé€šä¿¡ã‚’å®Ÿç¾ã§ãã‚‹ç‚¹ãŒç‰¹é•·ã§ã™ã€‚ref: gRPCã£ã¦ä½•ï¼Ÿã§ã‚‚æœ¬å½“ã«ã„ã„ãªã£ã¦æ€ã£ãŸã®ã¯ã“ã“ã˜ã‚ƒãªã„ï¼gRPCã§ã¯ã€IDLï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©è¨€èªï¼‰ã‚’ä½¿ã£ã¦ã‚ã‚‰ã‹ã˜ã‚APIä»•æ§˜ã‚’ .proto ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å®šç¾©ã—ã€ãã“ã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼å´ï¼†ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«å¿…è¦ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã²ãªå½¢ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã¤ã¾ã‚Šã“ã‚“ãªprotoãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šç¾©ã—ã¦ã‚ã’ã‚‹ã¨ã€APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç”Ÿæˆã€Client&Serverç”¨ã®ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚ã™ã”ã„ã€ã€ï¼ãƒ‡ãƒ¼ã‚¿ã®ã‚„ã‚Šå–ã‚Šã®ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…ã«æ™‚é–“ã‚’å–ã‚‰ã‚Œã‚‹ã“ã¨ãŒãªã„ã¨ã„ã†ã®ãŒåœ§å€’çš„ãƒ¡ãƒªãƒƒãƒˆã ã¨æ€ã£ã¦ã‚‹ï¼weather.protosyntax = \"proto3\";package proto.weather;service Weathers{    rpc Get (GetRequest) returns (GetResponse) {}}message Weather {    double ID = 1;    string CityName = 2;    double TempMax = 3;    double TempMin = 4;    double Wind = 5;    string Type = 6;    string Description = 7;}message GetRequest {    string CityName = 1;}message GetResponse {    Weather Weather = 1;}é–‹ç™ºç’°å¢ƒãƒ„ãƒ¼ãƒ«ãªã©OS: MacOSVisual Studio: IDEDotnet SDK(2.2.103): ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ bloomrpc : Postmanã®ã‚ˆã†ã«ã€GUIã§APIã‚’å©ã‘ã‚‹æœ‰é›£ã„ãƒ„ãƒ¼ãƒ«Docker for MacgRPC-Trainning : ä»Šå›åˆ©ç”¨ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªC#ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª<PackageReference Include=\"Dapper\" Version=\"1.50.5\" /><PackageReference Include=\"Google.Cloud.Language.V1\" Version=\"1.1.0\" /><PackageReference Include=\"Google.Protobuf\" Version=\"3.6.1\" /><PackageReference Include=\"Grpc\" Version=\"1.18.0\" /><PackageReference Include=\"Grpc.Core\" Version=\"1.18.0\" /><PackageReference Include=\"Grpc.Tools\" Version=\"1.18.0\">å…·ä½“çš„ãªå®Ÿè£…äº‹å‰æº–å‚™MacOSã«ã€protoãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¥è¨€èªã¸ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å…¥ã‚Œã¦ãŠãã“ã¨â†“ã¨ã£ã¦ã‚‚åˆ†ã‹ã‚Šã‚„ã™ã„ã§ã™ref: C#ã§gRPCç’°å¢ƒã‚’ä½œæˆã™ã‚‹ã€€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆDDDé¢¨ã«ã—ã¦ã¿ã¾ã—ãŸã€‚Application/Implementsä¸»ã«ã“ã“ã«RPCã®å®Ÿè£…ã‚’è¡Œã†(ASP.NET Coreã®Controllerã ã¨æ€ã£ã¦ã‚‚ã‚‰ã£ã¦å¤§ä¸ˆå¤«ã§ã™ï¼)æµã‚Œã¨ã—ã¦ã¯ã€è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŸºåº•ã‚¯ãƒ©ã‚¹ã¨ã¦ç¶™æ‰¿ã—ã¾ã™ã€‚ã‚ã¨ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¦ã€ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ›¸ã„ã¦ã„ãæ„Ÿã˜ã¦ã™ã€‚Implements/WeatherImpl.csusing Proto.Weather;using System.Threading.Tasks;using Grpc.Core;using WeatherApi.Application.Domain.Service.Interface;using System;namespace WeatherApi.Application.Implements{    public class WeatherImpl: Weathers.WeathersBase    {        IWeatherService service;        public WeatherImpl(IWeatherService _service) : base()        {            if (_service == null)            {                throw new ArgumentNullException(nameof(IWeatherService));            }            this.service = _service;        }        public override Task<GetResponse> Get(GetRequest request, ServerCallContext context)        {            string cityName = request.CityName;            var weathers = this.service.FindCurrentWeatherByCityName(cityName);            var response = new GetResponse();            response.Weather = weathers[0];            return Task.FromResult(response);        }    }}Application/Program.csImplementsã§ä½œæˆã—ãŸRPCã‚’Serverã«Bindã—ã¾ã™ã€‚æ®‹ã‚Šã®å®Ÿè£…ã¯ã€æ—¢å­˜ã®Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚using System;using Microsoft.Extensions.Configuration;using WeatherApi.Application.Infrastructure;using Grpc.Core;using Proto.Weather;using Proto.User;using WeatherApi.Application.Implements;using WeatherApi.Application.Domain.Service;using Proto.Ping;namespace Application{    public class Program    {        public static IConfigurationRoot configuration;        public static SqlHandler sqlHandler;        public static void Main(string[] args)        {            const int Port = 5000;            var weatherImpl = new WeatherImpl(new WeatherService());            var userImpl = new UserImpl(new UserService());            var pingImpl = new PingImpl();            Server server = new Server            {                Services = {                     Weathers.BindService(weatherImpl),                    Check.BindService(pingImpl),                    Users.BindService(userImpl)                },                Ports = { new ServerPort(\"0.0.0.0\", Port, ServerCredentials.Insecure) }            };            server.Start();            Console.WriteLine(\"Tozawa server listening on port \" + Port);            Console.WriteLine(\"Press any key to stop the server...\");            Console.Read();            server.ShutdownAsync().Wait();        }    }}ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒ­ãƒ¼ãƒ³git clone https://github.com/tozastation/gRPC-Training.gitgRPCã‚µãƒ¼ãƒã®èµ·å‹•docker-compose build; docker-compose up grpcä½¿ã„æ–¹bloomrpcã®èµ·å‹•ã€€& ãƒ—ãƒ©ã‚¹ãƒœã‚¿ãƒ³ã‹ã‚‰ä½œæˆã—ãŸ proto ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã‚ã¨ã¯ã€jsonã‚’æ¸¡ã™ã‹ã®ã‚ˆã†ã«æ›¸ãé€ä¿¡ã™ã‚‹ã ã‘ã§ã™çµ‚ã‚ã‚Šã«C#ã®gRPCå®Ÿè£…ãŒã‚ã¾ã‚Šãªã„ã®ã§ä»Šå›ã®è¨˜äº‹ã§ã€C#ã§ã®gRPCã‚µãƒ¼ãƒå®Ÿè£…ãŠã‚ˆã³Debugæ–¹æ³•ã®å…±æœ‰ãŒã§ãã‚Œã°ä½•ã‚ˆã‚Šã§ã™ï¼ä»Šå¾Œã¯Interceptor(Middleware)ã®å®Ÿè£…ã‚‚ã—ã¦ã„ããŸã„åˆ‡å®Ÿã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå¢—ãˆã¦ã»ã—ã„ã€ã€ã€","link":"https://qiita.com/tozastation/items/ec97be03ae61ab01de26","isoDate":"2019-02-05T06:03:12.000Z","dateMiliSeconds":1549346592000,"authorName":"tozastation","authorId":"tozastation"},{"title":"Nimãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ","contentSnippet":"æ¦‚è¦Slackã®APIã‚’å©ããƒãƒ£ãƒ³ãƒãƒ«ã®ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦åãå‡ºã™ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ã¦ã„ã‚‹é€”ä¸­ã€ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã§èº“ã„ãŸãŸã‚è‡ªåˆ†ç”¨ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ®‹ãã†ã¨æ€ã£ãŸã€‚Filemode5ã¤ã®ãƒ¢ãƒ¼ãƒ‰ãŒã‚ã‚‹ãŒã€Qiitaã§è¦‹ã‚‹ã®ã¯ä¸»ã«fmWriteãªã®ã§ã€å…¨ã¦è¨˜è¿°ã—ã¦ã¿ã‚‹ã€‚modecontentfmReadèª­ã¿è¾¼ã¿å°‚ç”¨fmWriteæ›¸ãè¾¼ã¿å°‚ç”¨fmReadWriteèª­ã¿æ›¸ãå¯èƒ½(ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ç”Ÿæˆ)fmReadWriteExistingèª­ã¿æ›¸ãå¯èƒ½(ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ä½•ã‚‚ã—ãªã„)fmAppendæœ«å°¾ã«æ›¸ãè¾¼ã¿â€»å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆExampleFileOpenNimãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆproc open(f: var File; filehandle: FileHandle; mode: FileMode = fmRead): bool {..}ã‚³ãƒ¼ãƒ‰var file : File = open(\"hoge.txt\", fmRead)var [å¤‰æ•°å] : [å‹å] = open([ãƒ•ã‚¡ã‚¤ãƒ«å], [ãƒ¢ãƒ¼ãƒ‰])èª²é¡Œjsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’åã‹ã›ãŸã‹ã£ãŸãŒã€ç¾çŠ¶ã§ã¯txtã®æ–¹æ³•ã—ã‹åˆ†ã‹ã‚‰ãªã‹ã£ãŸãŸã‚ã€jsonãƒ‡ãƒ¼ã‚¿ã‚’jsonãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ›¸ãå‡ºã›ã‚‹æ‰‹æ®µã‚’æ¢ã—ã¦ã„ããŸã„ã€‚å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸè¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ« : nimãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ¦ãƒ¼ã‚¶å : @6in ã•ã‚“","link":"https://qiita.com/tozastation/items/b017db842bf89dc8480b","isoDate":"2018-06-17T07:54:26.000Z","dateMiliSeconds":1529222066000,"authorName":"tozastation","authorId":"tozastation"}]},"__N_SSG":true}